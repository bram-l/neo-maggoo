[
  {
    "__docId__": 1,
    "kind": "external",
    "name": "Infinity",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Infinity",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Infinity",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 2,
    "kind": "external",
    "name": "NaN",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/NaN",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~NaN",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 3,
    "kind": "external",
    "name": "undefined",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~undefined",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 4,
    "kind": "external",
    "name": "null",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/null",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~null",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 5,
    "kind": "external",
    "name": "Object",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Object",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 6,
    "kind": "external",
    "name": "object",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~object",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 7,
    "kind": "external",
    "name": "Function",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Function",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 8,
    "kind": "external",
    "name": "function",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~function",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 9,
    "kind": "external",
    "name": "Boolean",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Boolean",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 10,
    "kind": "external",
    "name": "boolean",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~boolean",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 11,
    "kind": "external",
    "name": "Symbol",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Symbol",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 12,
    "kind": "external",
    "name": "Error",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Error",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 13,
    "kind": "external",
    "name": "EvalError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/EvalError",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~EvalError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 14,
    "kind": "external",
    "name": "InternalError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/InternalError",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~InternalError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 15,
    "kind": "external",
    "name": "RangeError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RangeError",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~RangeError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 16,
    "kind": "external",
    "name": "ReferenceError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ReferenceError",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~ReferenceError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 17,
    "kind": "external",
    "name": "SyntaxError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SyntaxError",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~SyntaxError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 18,
    "kind": "external",
    "name": "TypeError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypeError",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~TypeError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 19,
    "kind": "external",
    "name": "URIError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/URIError",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~URIError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 20,
    "kind": "external",
    "name": "Number",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Number",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 21,
    "kind": "external",
    "name": "number",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~number",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 22,
    "kind": "external",
    "name": "Date",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Date",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 23,
    "kind": "external",
    "name": "String",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~String",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 24,
    "kind": "external",
    "name": "string",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~string",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 25,
    "kind": "external",
    "name": "RegExp",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~RegExp",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 26,
    "kind": "external",
    "name": "Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 27,
    "kind": "external",
    "name": "Int8Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int8Array",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Int8Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 28,
    "kind": "external",
    "name": "Uint8Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Uint8Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 29,
    "kind": "external",
    "name": "Uint8ClampedArray",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8ClampedArray",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Uint8ClampedArray",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 30,
    "kind": "external",
    "name": "Int16Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int16Array",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Int16Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 31,
    "kind": "external",
    "name": "Uint16Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint16Array",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Uint16Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 32,
    "kind": "external",
    "name": "Int32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int32Array",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Int32Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 33,
    "kind": "external",
    "name": "Uint32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint32Array",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Uint32Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 34,
    "kind": "external",
    "name": "Float32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float32Array",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Float32Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 35,
    "kind": "external",
    "name": "Float64Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float64Array",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Float64Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 36,
    "kind": "external",
    "name": "Map",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Map",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 37,
    "kind": "external",
    "name": "Set",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Set",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 38,
    "kind": "external",
    "name": "WeakMap",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakMap",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~WeakMap",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 39,
    "kind": "external",
    "name": "WeakSet",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakSet",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~WeakSet",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 40,
    "kind": "external",
    "name": "ArrayBuffer",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~ArrayBuffer",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 41,
    "kind": "external",
    "name": "DataView",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~DataView",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 42,
    "kind": "external",
    "name": "JSON",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~JSON",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 43,
    "kind": "external",
    "name": "Promise",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Promise",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 44,
    "kind": "external",
    "name": "Generator",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Generator",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 45,
    "kind": "external",
    "name": "GeneratorFunction",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/GeneratorFunction",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~GeneratorFunction",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 46,
    "kind": "external",
    "name": "Reflect",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Reflect",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Reflect",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 47,
    "kind": "external",
    "name": "Proxy",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy",
    "memberof": "lib/.external-ecmascript.js",
    "static": true,
    "longname": "lib/.external-ecmascript.js~Proxy",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 48,
    "kind": "file",
    "name": "lib/DB.js",
    "content": "'use strict'\n\nconst CONSTRAINT_INDEX = Symbol('index')\nconst CONSTRAINT_UNIQUE = Symbol('unique')\nconst REGEX_INDEX = /:(.+)\\((.+)\\)/\nconst REGEX_UNIQUE = /:([^\\s)]+)[\\s)]*ASSERT[^.]+\\.([^\\s]+)\\sIS UNIQUE/i\n\nconst state = {\n\tinitialized: false,\n\tdriver: null,\n\tserver: null,\n\tconstraints: {},\n\tlastQuery: null\n}\n\nfunction init(host, user, pass, config)\n{\n\tif (state.driver)\n\t{\n\t\tstate.driver.close()\n\t}\n\n\tconst neo4j = require('neo4j-driver/lib/v1')\n\n\tstate.driver = neo4j.driver(host, neo4j.auth.basic(user, pass), config || {})\n\n\tstate.driver.onCompleted = (meta) =>\n\t{\n\t\tif (meta)\n\t\t{\n\t\t\tstate.server = meta\n\t\t}\n\t}\n\n\tstate.initialized = true\n}\n\nfunction getSession(mode)\n{\n\tif (!state.initialized)\n\t{\n\t\tthrow new Error('Database not initialized')\n\t}\n\n\treturn state.driver.session(mode)\n}\n\nfunction beginTransaction(session = null)\n{\n\tsession = session || getSession()\n\n\tconst transaction = session.beginTransaction()\n\n\ttransaction.session = session\n\ttransaction.$nodes = []\n\n\tconst run = transaction.run\n\n\ttransaction.run = async function(query, parameters)\n\t{\n\t\tawait _ensureRestrictions()\n\n\t\tlet error = null\n\t\tlet result = null\n\n\t\ttry\n\t\t{\n\t\t\tresult = await run.apply(transaction, arguments).then(r => r)\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\terror = e\n\t\t}\n\n\t\tstate.lastQuery = { query, parameters, error }\n\n\t\tif (error)\n\t\t{\n\t\t\tconst e = new Error(error.message || error)\n\n\t\t\te.code = error.code\n\n\t\t\tthrow e\n\t\t}\n\n\t\treturn result\n\t}\n\n\treturn transaction\n}\n\n/**\n * Run a query against the DB\n *\n * @param {String} query The Cypher query string\n * @param {Object} parameters The parameters used in the query\n * @param {neo4j.Session} [session=null] An active DB session\n *\n * @returns {neo4j.Result} The result\n */\nasync function runQuery(query, parameters, session = null)\n{\n\tawait _ensureRestrictions()\n\n\tsession = session || getSession()\n\n\tlet error = null\n\tlet result = null\n\n\ttry\n\t{\n\t\tresult = await session.run(query, parameters)\n\t}\n\tcatch (e)\n\t{\n\t\terror = e\n\t}\n\n\tstate.lastQuery = { query, parameters, error }\n\n\tsession.close()\n\n\tif (error)\n\t{\n\t\tconst e = new Error(error.message || error)\n\n\t\te.code = error.code\n\n\t\tthrow e\n\t}\n\n\treturn result\n}\n\nasync function getScalar(query, parameters, session = null)\n{\n\tconst result = await runQuery(query, parameters, session)\n\n\treturn result.records[0].get(0)\n}\n\nfunction addIndex(label, property, now = true)\n{\n\t_addRestriction(CONSTRAINT_INDEX, label, property)\n\n\tif (now)\n\t{\n\t\treturn _ensureRestrictions(CONSTRAINT_INDEX)\n\t}\n\n\treturn null\n}\n\nfunction addUnique(label, property, now = true)\n{\n\t_addRestriction(CONSTRAINT_UNIQUE, label, property)\n\n\tif (now)\n\t{\n\t\treturn _ensureRestrictions(CONSTRAINT_UNIQUE)\n\t}\n\n\treturn null\n}\n\nasync function dropIndex(label, property)\n{\n\tconst session = getSession()\n\n\tawait session.run(`DROP INDEX ON :\\`${ label }\\`(\\`${ property }\\`)`)\n\n\tsession.close()\n\n\t_removeRestriction(CONSTRAINT_INDEX, label, property)\n}\n\nasync function dropUnique(label, property)\n{\n\tconst session = getSession()\n\n\tawait session.run(`DROP CONSTRAINT ON (n:\\`${ label }\\`) ASSERT n.\\`${ property }\\` IS UNIQUE`)\n\n\tsession.close()\n\n\t_removeRestriction(CONSTRAINT_UNIQUE, label, property)\n}\n\nfunction _addRestriction(key, label, property)\n{\n\tstate.constraints[key] = state.constraints[key] || {}\n\n\tconst name = _getRestrictionName(label, property)\n\n\tif (!state.constraints[key][name])\n\t{\n\t\tstate.constraints[key][name] = {\n\t\t\tlabel,\n\t\t\tproperty,\n\t\t\tadded: false\n\t\t}\n\t}\n}\n\nfunction _removeRestriction(key, label, property)\n{\n\tconst name = _getRestrictionName(label, property)\n\n\tif (name in state.constraints[key])\n\t{\n\t\tdelete state.constraints[key]\n\t}\n}\n\nfunction _getRestrictionName(label, property)\n{\n\treturn  `${ label }:${ property }`\n}\n\nasync function _ensureRestrictions(types = null)\n{\n\tconst queries = []\n\tconst adding = []\n\tlet indexes = null\n\n\tif (types === null)\n\t{\n\t\ttypes = [CONSTRAINT_INDEX, CONSTRAINT_UNIQUE]\n\t}\n\n\tif (!Array.isArray(types))\n\t{\n\t\ttypes = [types]\n\t}\n\n\tfor (const key of types)\n\t{\n\t\tif (!state.constraints[key])\n\t\t{\n\t\t\tcontinue\n\t\t}\n\n\t\tfor (const item of Object.values(state.constraints[key]))\n\t\t{\n\t\t\tconst { added, label, property } = item\n\n\t\t\tif (added)\n\t\t\t{\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tif (key === CONSTRAINT_INDEX)\n\t\t\t{\n\t\t\t\tif (!indexes)\n\t\t\t\t{\n\t\t\t\t\tindexes = await getIndexes()\n\t\t\t\t}\n\n\t\t\t\tif (label in indexes && indexes[label].includes(property))\n\t\t\t\t{\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\n\t\t\t\tqueries.push(`\n\t\t\t\t\tCREATE INDEX ON :\\`${ label }\\`(\\`${ property }\\`)\n\t\t\t\t`)\n\n\t\t\t\tadding.push(item)\n\t\t\t}\n\t\t\telse if (key === CONSTRAINT_UNIQUE)\n\t\t\t{\n\t\t\t\tqueries.push(`\n\t\t\t\t\tCREATE CONSTRAINT ON (n:\\`${ label }\\`)\n\t\t\t\t\tASSERT n.\\`${ property }\\` IS UNIQUE\n\t\t\t\t`)\n\n\t\t\t\tadding.push(item)\n\t\t\t}\n\t\t}\n\t}\n\n\tif (!queries.length)\n\t{\n\t\treturn null\n\t}\n\n\tconst session = getSession()\n\n\tconst result = await session.run(queries.join('\\n'))\n\n\tsession.close()\n\n\tfor (const item of adding)\n\t{\n\t\titem.added = true\n\t}\n\n\treturn result\n}\n\nasync function getIndexes()\n{\n\tconst session = getSession()\n\n\tconst result = await session.run('CALL db.indexes()')\n\n\tsession.close()\n\n\tconst indexes = {}\n\n\tfor (const record of result.records)\n\t{\n\t\tconst description = record.get('description')\n\t\tconst [, label, name] = description.match(REGEX_INDEX)\n\n\t\tindexes[label] = indexes[label] || []\n\t\tindexes[label].push(name)\n\t}\n\n\treturn indexes\n}\n\nasync function getUnique()\n{\n\tconst session = getSession()\n\n\tconst result = await session.run('CALL db.constraints()')\n\n\tsession.close()\n\n\tconst constraints = {}\n\n\tfor (const record of result.records)\n\t{\n\t\tconst description = record.get('description')\n\t\tconst [, label, name] = description.match(REGEX_UNIQUE)\n\n\t\tconstraints[label] = constraints[label] || []\n\t\tconstraints[label].push(name)\n\t}\n\n\treturn constraints\n}\n\nfunction exit()\n{\n\tif (state.driver)\n\t{\n\t\tstate.driver.close()\n\t}\n\n\tstate.driver = null\n\tstate.server = null\n\tstate.initialized = false\n}\n\nmodule.exports = {\n\tinit,\n\tstate,\n\tsession: getSession,\n\tbeginTransaction,\n\tquery: runQuery,\n\tgetScalar,\n\taddIndex,\n\taddUnique,\n\tdropIndex,\n\tdropUnique,\n\tgetIndexes,\n\tgetUnique,\n\texit\n}\n",
    "static": true,
    "longname": "/Volumes/DATA/Sites/projects/36_maggoo/neo-maggoo/lib/DB.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 49,
    "kind": "variable",
    "name": "CONSTRAINT_INDEX",
    "memberof": "lib/DB.js",
    "static": true,
    "longname": "lib/DB.js~CONSTRAINT_INDEX",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 3,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 50,
    "kind": "variable",
    "name": "CONSTRAINT_UNIQUE",
    "memberof": "lib/DB.js",
    "static": true,
    "longname": "lib/DB.js~CONSTRAINT_UNIQUE",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 4,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 51,
    "kind": "variable",
    "name": "REGEX_INDEX",
    "memberof": "lib/DB.js",
    "static": true,
    "longname": "lib/DB.js~REGEX_INDEX",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 5,
    "undocument": true,
    "type": {
      "types": [
        "undefined"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 52,
    "kind": "variable",
    "name": "REGEX_UNIQUE",
    "memberof": "lib/DB.js",
    "static": true,
    "longname": "lib/DB.js~REGEX_UNIQUE",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 6,
    "undocument": true,
    "type": {
      "types": [
        "undefined"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 53,
    "kind": "variable",
    "name": "state",
    "memberof": "lib/DB.js",
    "static": true,
    "longname": "lib/DB.js~state",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 8,
    "undocument": true,
    "type": {
      "types": [
        "{\"initialized\": *, \"driver\": *, \"server\": *, \"constraints\": *, \"lastQuery\": *}"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 54,
    "kind": "function",
    "name": "init",
    "memberof": "lib/DB.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/DB.js~init",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 16,
    "undocument": true,
    "params": [
      {
        "name": "host",
        "types": [
          "*"
        ]
      },
      {
        "name": "user",
        "types": [
          "*"
        ]
      },
      {
        "name": "pass",
        "types": [
          "*"
        ]
      },
      {
        "name": "config",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 55,
    "kind": "function",
    "name": "getSession",
    "memberof": "lib/DB.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/DB.js~getSession",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 38,
    "undocument": true,
    "params": [
      {
        "name": "mode",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 56,
    "kind": "function",
    "name": "beginTransaction",
    "memberof": "lib/DB.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/DB.js~beginTransaction",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 48,
    "undocument": true,
    "params": [
      {
        "name": "session",
        "optional": true,
        "types": [
          "undefined"
        ],
        "defaultValue": "undefined"
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 57,
    "kind": "function",
    "name": "runQuery",
    "memberof": "lib/DB.js",
    "generator": false,
    "async": true,
    "static": true,
    "longname": "lib/DB.js~runQuery",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": "Run a query against the DB",
    "lineNumber": 101,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{neo4j.Result} The result"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "String"
        ],
        "spread": false,
        "optional": false,
        "name": "query",
        "description": "The Cypher query string"
      },
      {
        "nullable": null,
        "types": [
          "Object"
        ],
        "spread": false,
        "optional": false,
        "name": "parameters",
        "description": "The parameters used in the query"
      },
      {
        "nullable": null,
        "types": [
          "neo4j.Session"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "null",
        "defaultRaw": null,
        "name": "session",
        "description": "An active DB session"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "neo4j.Result"
      ],
      "spread": false,
      "description": "The result"
    },
    "ignore": true
  },
  {
    "__docId__": 58,
    "kind": "function",
    "name": "getScalar",
    "memberof": "lib/DB.js",
    "generator": false,
    "async": true,
    "static": true,
    "longname": "lib/DB.js~getScalar",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 135,
    "undocument": true,
    "params": [
      {
        "name": "query",
        "types": [
          "*"
        ]
      },
      {
        "name": "parameters",
        "types": [
          "*"
        ]
      },
      {
        "name": "session",
        "optional": true,
        "types": [
          "undefined"
        ],
        "defaultValue": "undefined"
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 59,
    "kind": "function",
    "name": "addIndex",
    "memberof": "lib/DB.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/DB.js~addIndex",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 142,
    "undocument": true,
    "params": [
      {
        "name": "label",
        "types": [
          "*"
        ]
      },
      {
        "name": "property",
        "types": [
          "*"
        ]
      },
      {
        "name": "now",
        "optional": true,
        "types": [
          "boolean"
        ],
        "defaultRaw": true,
        "defaultValue": "true"
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 60,
    "kind": "function",
    "name": "addUnique",
    "memberof": "lib/DB.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/DB.js~addUnique",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 154,
    "undocument": true,
    "params": [
      {
        "name": "label",
        "types": [
          "*"
        ]
      },
      {
        "name": "property",
        "types": [
          "*"
        ]
      },
      {
        "name": "now",
        "optional": true,
        "types": [
          "boolean"
        ],
        "defaultRaw": true,
        "defaultValue": "true"
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 61,
    "kind": "function",
    "name": "dropIndex",
    "memberof": "lib/DB.js",
    "generator": false,
    "async": true,
    "static": true,
    "longname": "lib/DB.js~dropIndex",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 166,
    "undocument": true,
    "params": [
      {
        "name": "label",
        "types": [
          "*"
        ]
      },
      {
        "name": "property",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 62,
    "kind": "function",
    "name": "dropUnique",
    "memberof": "lib/DB.js",
    "generator": false,
    "async": true,
    "static": true,
    "longname": "lib/DB.js~dropUnique",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 177,
    "undocument": true,
    "params": [
      {
        "name": "label",
        "types": [
          "*"
        ]
      },
      {
        "name": "property",
        "types": [
          "*"
        ]
      }
    ],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 63,
    "kind": "function",
    "name": "_addRestriction",
    "memberof": "lib/DB.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/DB.js~_addRestriction",
    "access": "private",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 188,
    "undocument": true,
    "ignore": true,
    "params": [
      {
        "name": "key",
        "types": [
          "*"
        ]
      },
      {
        "name": "label",
        "types": [
          "*"
        ]
      },
      {
        "name": "property",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 64,
    "kind": "function",
    "name": "_removeRestriction",
    "memberof": "lib/DB.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/DB.js~_removeRestriction",
    "access": "private",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 204,
    "undocument": true,
    "ignore": true,
    "params": [
      {
        "name": "key",
        "types": [
          "*"
        ]
      },
      {
        "name": "label",
        "types": [
          "*"
        ]
      },
      {
        "name": "property",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 65,
    "kind": "function",
    "name": "_getRestrictionName",
    "memberof": "lib/DB.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/DB.js~_getRestrictionName",
    "access": "private",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 214,
    "undocument": true,
    "ignore": true,
    "params": [
      {
        "name": "label",
        "types": [
          "*"
        ]
      },
      {
        "name": "property",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 66,
    "kind": "function",
    "name": "_ensureRestrictions",
    "memberof": "lib/DB.js",
    "generator": false,
    "async": true,
    "static": true,
    "longname": "lib/DB.js~_ensureRestrictions",
    "access": "private",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 219,
    "undocument": true,
    "ignore": true,
    "params": [
      {
        "name": "types",
        "optional": true,
        "types": [
          "undefined"
        ],
        "defaultValue": "undefined"
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 67,
    "kind": "function",
    "name": "getIndexes",
    "memberof": "lib/DB.js",
    "generator": false,
    "async": true,
    "static": true,
    "longname": "lib/DB.js~getIndexes",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 300,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 68,
    "kind": "function",
    "name": "getUnique",
    "memberof": "lib/DB.js",
    "generator": false,
    "async": true,
    "static": true,
    "longname": "lib/DB.js~getUnique",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 322,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 69,
    "kind": "function",
    "name": "exit",
    "memberof": "lib/DB.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/DB.js~exit",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/DB.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 344,
    "undocument": true,
    "params": [],
    "return": null,
    "ignore": true
  },
  {
    "__docId__": 70,
    "kind": "file",
    "name": "lib/Graph.js",
    "content": "'use strict'\n\nconst neo4j = require('neo4j-driver/lib/v1')\n\nconst _db = Symbol('db')\nconst _Node = Symbol('Node')\nconst _Relationship = Symbol('Relationship')\nconst _NodeCollection = Symbol('NodeCollection')\n\n/**\n * Object-Graph Map\n *\n * @class Graph\n */\nclass Graph\n{\n\tstatic get TYPE_NODE()\n\t{\n\t\treturn 'node'\n\t}\n\n\tstatic get TYPE_RELATIONSHIP()\n\t{\n\t\treturn 'relationship'\n\t}\n\n\tstatic get TYPE_INTEGER()\n\t{\n\t\treturn 'integer'\n\t}\n\n\tstatic get TYPE_ARRAY()\n\t{\n\t\treturn 'array'\n\t}\n\n\t/**\n\t * Get a database instance.\n\t *\n\t * @readonly\n\t * @static\n\t */\n\tstatic get db()\n\t{\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tthis[_db] = this[_db] || require('./DB')\n\n\t\treturn this[_db]\n\t}\n\n\tstatic get Node()\n\t{\n\t\tif (!this[_Node])\n\t\t{\n\t\t\t/**\n\t\t\t * @private\n\t\t\t */\n\t\t\tthis[_Node] = require('./Node')\n\t\t}\n\n\t\treturn this[_Node]\n\t}\n\n\tstatic get Relationship()\n\t{\n\t\tif (!this[_Relationship])\n\t\t{\n\t\t\t/**\n\t\t\t * @private\n\t\t\t */\n\t\t\tthis[_Relationship] = require('./Relationship')\n\t\t}\n\n\t\treturn this[_Relationship]\n\t}\n\n\tstatic get NodeCollection()\n\t{\n\t\tif (!this[_NodeCollection])\n\t\t{\n\t\t\t/**\n\t\t\t * @private\n\t\t\t */\n\t\t\tthis[_NodeCollection] = require('./NodeCollection')\n\t\t}\n\n\t\treturn this[_NodeCollection]\n\t}\n\n\t/**\n\t * Build a graph from query results.\n\t * Map variables returned from the query to Nodes\n\t *\n\t * @static\n\t * @param {string} query The search query.\n\t * @param {object} parameters The parameters used in the search query.\n\t * @param {object} models variables and Node models as key-value pairs.\n\t * @param {object} [links=null] virtual relationships between records\n\t * @returns {Graph} The resulting graph.\n\t */\n\tstatic build(query, parameters, models = {}, links = null)\n\t{\n\t\treturn this.db.query(query, parameters)\n\t\t\t.then(result =>\n\t\t\t{\n\t\t\t\treturn new this(result, models, links)\n\t\t\t})\n\t}\n\n\t/**\n\t * Creates an instance of Graph.\n\t *\n\t * @param {neo4j.Result} result Result of a query.\n\t * @param {object} models variables and Node models as key-value pairs.\n\t * @param {object} [links=null] virtual relationships between records\n\t */\n\tconstructor(result, models = {}, links = null)\n\t{\n\t\tthis.nodes         = new Map()\n\t\tthis.relationships = new Map()\n\t\tthis.index         = new Map()\n\t\tthis.references    = {}\n\t\tthis.models        = models\n\t\tthis.links         = links\n\n\t\tif (result && result.records)\n\t\t{\n\t\t\tthis.addRecords(result.records)\n\t\t}\n\t}\n\n\t/**\n\t * Run a Cypher query and add the result to the current Graph instance\n\t *\n\t * @param {string} query A Cypher query\n\t * @param {Object} parameters Parameters used in the query\n\t * @param {Object} [models] Map variables to Models\n\t * @param {Object} [links] Link results to a specific Model\n\t * @returns {Promise} A promise\n\t */\n\trun(query, parameters, models = {}, links = null)\n\t{\n\t\tObject.assign(this.models, models)\n\n\t\tif (links)\n\t\t{\n\t\t\tthis.links = this.links || {}\n\t\t\tObject.assign(this.links, links)\n\t\t}\n\n\t\treturn this.constructor.db.query(query, parameters)\n\t\t\t.then(result =>\n\t\t\t{\n\t\t\t\tthis.addRecords(result.records)\n\t\t\t})\n\t}\n\n\t/**\n\t * Add records to the graph\n\t *\n\t * @param {neo4j.Record[]} records Neo4j Records\n\t */\n\taddRecords(records)\n\t{\n\t\tfor (const record of records)\n\t\t{\n\t\t\trecord.forEach(this.add.bind(this))\n\n\t\t\tif (this.links)\n\t\t\t{\n\t\t\t\tthis.addLinks(record)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Link record items\n\t *\n\t * @param {neo4j.Record} record Neo4j Record\n\t */\n\taddLinks(record)\n\t{\n\t\tconst names = Object.keys(this.links)\n\n\t\tfor (const name of names)\n\t\t{\n\t\t\tconst link = this.links[name]\n\n\t\t\tlink.items = link.items || []\n\n\t\t\tconst startKey = link.start || Object.keys(this.models)[0]\n\t\t\tconst endKey = link.end || name\n\n\t\t\tif (record.has(startKey) && record.has(endKey))\n\t\t\t{\n\t\t\t\tconst start = record.get(startKey).identity.toNumber()\n\n\t\t\t\tconst entity = record.get(endKey)\n\t\t\t\tconst type = Graph.typeOf(entity)\n\t\t\t\tconst value = entity.identity ? entity.identity.toNumber() : entity\n\n\t\t\t\tconst item = {\n\t\t\t\t\tstart,\n\t\t\t\t\tvalue,\n\t\t\t\t\ttype\n\t\t\t\t}\n\n\t\t\t\tif (endKey in this.models)\n\t\t\t\t{\n\t\t\t\t\tlink.model = this.models[endKey]\n\t\t\t\t}\n\n\t\t\t\tlink.items.push(item)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Add one or more entities to the graph\n\t *\n\t * @param {neo4j.types.Node|neo4j.types.Node[]|neo4j.types.Relationship|neo4j.types.Relationship[]} entity One or more entities\n\t * @param {string} key The key associated with this\n\t */\n\tadd(entity, key)\n\t{\n\t\tconst type = Graph.typeOf(entity)\n\n\t\tif (type === Graph.TYPE_ARRAY)\n\t\t{\n\t\t\tfor (const item of entity)\n\t\t\t{\n\t\t\t\tthis.add(item, key)\n\t\t\t}\n\t\t\treturn\n\t\t}\n\n\t\tconst id = Graph.getId(entity)\n\n\t\tthis.references[key] = this.references[key] || []\n\t\tthis.references[key].push(id !== null ? id : entity)\n\n\t\tif (type !== Graph.TYPE_NODE && type !== Graph.TYPE_RELATIONSHIP)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tentity.$key = key\n\n\t\tconst map = this.getMap(entity)\n\t\tlet current\n\n\t\tif (map.has(id))\n\t\t{\n\t\t\tcurrent = map.get(id)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcurrent = {\n\t\t\t\tentity\n\t\t\t}\n\t\t}\n\n\t\tif (key in this.models)\n\t\t{\n\t\t\tconst $Model = this.models[key]\n\n\t\t\tcurrent.models = current.models || {}\n\t\t\tcurrent.models[$Model.name] = new $Model(entity, this)\n\t\t}\n\n\t\tmap.set(id, current)\n\n\t\tif (type === Graph.TYPE_RELATIONSHIP)\n\t\t{\n\t\t\tthis.setRelationshipsIndex(entity)\n\t\t}\n\t}\n\n\tsetRelationshipsIndex(entity)\n\t{\n\t\tconst id = Graph.getId(entity)\n\t\tconst index = this.index\n\n\t\tindex[entity.type] = index[entity.type] || {\n\t\t\tin: {},\n\t\t\tout: {},\n\t\t}\n\n\t\tconst start = Graph.getId(entity.start)\n\t\tconst end = Graph.getId(entity.end)\n\n\t\tconst map = index[entity.type]\n\n\t\tmap.out[start] = map.out[start] || {}\n\t\tmap.out[start][end] = id\n\n\t\tmap.in[end] = map.in[end] || {}\n\t\tmap.in[end][start] = id\n\t}\n\n\t/**\n\t * Remove one or more entities from the graph\n\t *\n\t * @param {neo4j.types.Node|neo4j.types.Node[]|neo4j.types.Relationship|neo4j.types.Relationship[]|Node|Node[]|Relationship|Relationship[]} obj One or more objects\n\t */\n\tremove(obj)\n\t{\n\t\tif (Array.isArray(obj))\n\t\t{\n\t\t\tfor (const item of obj)\n\t\t\t{\n\t\t\t\tthis.remove(item)\n\t\t\t}\n\t\t\treturn\n\t\t}\n\n\t\tconst entity = Graph.getEntity(obj)\n\t\tconst id = Graph.getId(entity)\n\n\t\tthis.getMap(entity).delete(id)\n\n\t\tconst map = this.references[entity.$key]\n\t\tconst i = map.indexOf(id)\n\n\t\tif (i >= 0)\n\t\t{\n\t\t\tmap.splice(i, 1)\n\t\t}\n\t}\n\n\t/**\n\t * Get the Neo4j node entity\n\t *\n\t * @param {Node|neo4j.types.Node|Object} subject Anything that could represent a node\n\t * @returns {neo4j.types.Node} The Neo4j Node entity\n\t */\n\tstatic getEntity(subject)\n\t{\n\t\tif (subject instanceof Graph.Node || subject instanceof Graph.Relationship)\n\t\t{\n\t\t\treturn subject.$entity\n\t\t}\n\n\t\tif (subject instanceof neo4j.types.Node || subject instanceof neo4j.types.Relationship)\n\t\t{\n\t\t\treturn subject\n\t\t}\n\n\t\tif (subject.entity)\n\t\t{\n\t\t\treturn subject.entity\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * Get the type of the entity\n\t *\n\t * @param {any} entity Entity object\n\t * @returns {string} Graph.TYPE_NODE, Graph.TYPE_RELATIONSHIP, Graph.TYPE_INTEGER or native JS type\n\t */\n\tstatic typeOf(entity)\n\t{\n\t\tif (entity instanceof neo4j.types.Node)\n\t\t{\n\t\t\treturn Graph.TYPE_NODE\n\t\t}\n\n\t\tif (entity instanceof neo4j.types.Relationship)\n\t\t{\n\t\t\treturn Graph.TYPE_RELATIONSHIP\n\t\t}\n\n\t\tif (neo4j.isInt(entity))\n\t\t{\n\t\t\treturn Graph.TYPE_INTEGER\n\t\t}\n\n\t\tif (Array.isArray(entity))\n\t\t{\n\t\t\treturn Graph.TYPE_ARRAY\n\t\t}\n\n\t\treturn typeof entity\n\t}\n\n\t/**\n\t * Get Neo4j Node id\n\t *\n\t * @param {Node|neo4j.types.Node|Object} subject Anything that could represent a node\n\t * @returns {Number} The Neo4j Node ID as number\n\t */\n\tstatic getId(subject)\n\t{\n\t\tif (!isNaN(subject))\n\t\t{\n\t\t\treturn parseInt(subject)\n\t\t}\n\n\t\tif (subject instanceof Graph.Node || subject instanceof Graph.Relationship)\n\t\t{\n\t\t\treturn subject.$id\n\t\t}\n\n\t\tif (subject instanceof neo4j.types.Node || subject instanceof neo4j.types.Relationship)\n\t\t{\n\t\t\treturn subject.identity.toNumber()\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * Get the map used for the entity\n\t *\n\t * @param {any} entity Entity object\n\t * @returns {Map} The entity map\n\t */\n\tgetMap(entity)\n\t{\n\t\tconst type = Graph.typeOf(entity)\n\n\t\tif (type === Graph.TYPE_NODE || entity instanceof Graph.Node)\n\t\t{\n\t\t\treturn this.nodes\n\t\t}\n\n\t\tif (type === Graph.TYPE_RELATIONSHIP || (entity.prototype && entity.prototype instanceof Graph.Relationship))\n\t\t{\n\t\t\treturn this.relationships\n\t\t}\n\n\t\tthrow new Error(`No map defined for this entity: ${ entity }`)\n\t}\n\n\t/**\n\t * Get Relationship from the graph\n\t *\n\t * @param {Node} start Start node\n\t * @param {Node} end End node\n\t * @param {Function} $Relationship Relationship class\n\t * @returns {Relationship} Relationship or null if no match was found\n\t */\n\tgetRelationship(start, end, $Relationship)\n\t{\n\t\tstart = Graph.getId(start)\n\t\tend = Graph.getId(end)\n\n\t\tlet relationshipId = null\n\n\t\tconst index = this.index[$Relationship.type]\n\n\t\tif (!index)\n\t\t{\n\t\t\treturn null\n\t\t}\n\n\t\tif ($Relationship.direction === Graph.Relationship.OUT)\n\t\t{\n\t\t\tif (index.out[start] && index.out[start][end] >= 0)\n\t\t\t{\n\t\t\t\trelationshipId = index.out[start][end]\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn null\n\t\t\t}\n\t\t}\n\t\telse if ($Relationship.direction === Graph.Relationship.IN)\n\t\t{\n\t\t\tif (index.in[start] && index.in[start][end] >= 0)\n\t\t\t{\n\t\t\t\trelationshipId = index.in[start][end]\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn null\n\t\t\t}\n\t\t}\n\t\t// At this point the relationship could be in any direction so,\n\t\t// we simply check if a matching relationship is found in the index.\n\t\telse if (index.out[start] && index.out[start][end] >= 0)\n\t\t{\n\t\t\trelationshipId = index.out[start][end]\n\t\t}\n\t\telse if (index.in[start] && index.in[start][end] >= 0)\n\t\t{\n\t\t\trelationshipId = index.in[start][end]\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn null\n\t\t}\n\n\t\tconst relationship = this.relationships.get(relationshipId)\n\n\t\tif (!relationship.model)\n\t\t{\n\t\t\trelationship.model = new $Relationship(relationship.entity, this)\n\t\t}\n\n\t\treturn relationship.model\n\t}\n\n\t/**\n\t * Get related nodes\n\t *\n\t * @param {Node} node Start node\n\t * @param {Function} $Relationship Relationship class\n\t * @returns {Node[]} Related nodes\n\t */\n\tgetRelated(node, $Relationship)\n\t{\n\t\tconst id = Graph.getId(node)\n\n\t\tconst type = $Relationship.type\n\t\tconst direction = $Relationship.direction\n\n\t\tconst index = this.index[type]\n\t\tlet others = []\n\n\t\tif (!index)\n\t\t{\n\t\t\treturn others\n\t\t}\n\n\t\tif ([Graph.Relationship.OUT, Graph.Relationship.ANY].includes(direction))\n\t\t{\n\t\t\tif (id in index.out)\n\t\t\t{\n\t\t\t\tothers = others.concat(Object.keys(index.out[id]))\n\t\t\t}\n\t\t}\n\n\t\tif ([Graph.Relationship.IN, Graph.Relationship.ANY, Graph.Relationship.BOTH].includes(direction))\n\t\t{\n\t\t\tif (id in index.in)\n\t\t\t{\n\t\t\t\tothers = others.concat(Object.keys(index.in[id]))\n\t\t\t}\n\t\t}\n\n\t\tconst unique = others.filter((other, position, array) => array.indexOf(other) === position)\n\n\t\tconst results = unique.map(other =>\n\t\t{\n\t\t\treturn this.getNodeModel(other, $Relationship.Model)\n\t\t})\n\n\t\treturn $Relationship.singular ? results[0] : results\n\t}\n\n\t/**\n\t * Wrap a Neo4j node in a specified Node model\n\t *\n\t * @param {Number|neo4j.integer} id The Neo4j Node ID\n\t * @param {Function<Node>} $Node The Node Model Class\n\t * @returns {Node} The Node model\n\t */\n\tgetNodeModel(id, $Node)\n\t{\n\t\tif (neo4j.isInt(id))\n\t\t{\n\t\t\tid = id.toNumber()\n\t\t}\n\n\t\tid = parseInt(id, 10)\n\n\t\tconst node = this.nodes.get(id)\n\n\t\tif (!node)\n\t\t{\n\t\t\tthrow new Error('Node not found')\n\t\t}\n\n\t\tif (!$Node)\n\t\t{\n\t\t\t$Node = Graph.Node\n\t\t}\n\n\t\tnode.models = node.models || {}\n\n\t\tif (!node.models[$Node.name])\n\t\t{\n\t\t\tnode.models[$Node.name] = new $Node(node.entity, this)\n\t\t}\n\n\t\treturn node.models[$Node.name]\n\t}\n\n\t/**\n\t * Get all Nodes for a reference used in the Cypher query\n\t *\n\t * @param {string} reference The reference\n\t * @returns {array} An array of nodes\n\t */\n\tgetNodes(reference)\n\t{\n\t\tconst ids = this.references[reference]\n\t\tconst nodes = []\n\t\tconst Model = this.models[reference]\n\n\t\tif (!ids)\n\t\t{\n\t\t\treturn nodes\n\t\t}\n\n\t\tfor (const id of ids)\n\t\t{\n\t\t\tnodes.push(this.getNodeModel(id, Model))\n\t\t}\n\n\t\treturn nodes\n\t}\n\n\t/**\n\t * Get linked results mapped to Models\n\t *\n\t * @param {Node} node The start node\n\t * @param {string} name The name of the link\n\t * @returns {any} The linked result\n\t */\n\tgetLinked(node, name)\n\t{\n\t\tif (!this.links || !this.links[name] || !this.links[name].items)\n\t\t{\n\t\t\treturn null\n\t\t}\n\n\t\tconst entity = Graph.getEntity(node)\n\t\tconst id = Graph.getId(entity)\n\t\tconst link = this.links[name]\n\t\tconst results = []\n\n\t\tfor (const item of link.items)\n\t\t{\n\t\t\tif (item.start !== id)\n\t\t\t{\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tlet value = item.value\n\n\t\t\tif (item.type === Graph.TYPE_NODE)\n\t\t\t{\n\t\t\t\tvalue = this.getNodeModel(value, link.model)\n\t\t\t}\n\n\t\t\tif (item.type === Graph.TYPE_INTEGER)\n\t\t\t{\n\t\t\t\tvalue = value.toNumber()\n\t\t\t}\n\n\t\t\tif (item.type === Graph.TYPE_ARRAY && link.model && link.model.prototype instanceof Graph.NodeCollection)\n\t\t\t{\n\t\t\t\tconst Collection = link.model\n\n\t\t\t\tvalue = new Collection(value)\n\n\t\t\t\t// Assume collections are 'singular' by default\n\t\t\t\tif (link.singular !== false)\n\t\t\t\t{\n\t\t\t\t\treturn value\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (link.singular)\n\t\t\t{\n\t\t\t\treturn value\n\t\t\t}\n\n\t\t\tresults.push(value)\n\t\t}\n\n\t\treturn results\n\t}\n}\n\nmodule.exports = Graph\n",
    "static": true,
    "longname": "/Volumes/DATA/Sites/projects/36_maggoo/neo-maggoo/lib/Graph.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 71,
    "kind": "variable",
    "name": "neo4j",
    "memberof": "lib/Graph.js",
    "static": true,
    "longname": "lib/Graph.js~neo4j",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/Graph.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 3,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 72,
    "kind": "variable",
    "name": "_db",
    "memberof": "lib/Graph.js",
    "static": true,
    "longname": "lib/Graph.js~_db",
    "access": "private",
    "export": false,
    "importPath": "neo-maggoo/lib/Graph.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 5,
    "undocument": true,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 73,
    "kind": "variable",
    "name": "_Node",
    "memberof": "lib/Graph.js",
    "static": true,
    "longname": "lib/Graph.js~_Node",
    "access": "private",
    "export": false,
    "importPath": "neo-maggoo/lib/Graph.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 6,
    "undocument": true,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 74,
    "kind": "variable",
    "name": "_Relationship",
    "memberof": "lib/Graph.js",
    "static": true,
    "longname": "lib/Graph.js~_Relationship",
    "access": "private",
    "export": false,
    "importPath": "neo-maggoo/lib/Graph.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 7,
    "undocument": true,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 75,
    "kind": "variable",
    "name": "_NodeCollection",
    "memberof": "lib/Graph.js",
    "static": true,
    "longname": "lib/Graph.js~_NodeCollection",
    "access": "private",
    "export": false,
    "importPath": "neo-maggoo/lib/Graph.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 8,
    "undocument": true,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 76,
    "kind": "class",
    "name": "Graph",
    "memberof": "lib/Graph.js",
    "static": true,
    "longname": "lib/Graph.js~Graph",
    "access": "public",
    "export": true,
    "importPath": "neo-maggoo/lib/Graph.js",
    "importStyle": "Graph",
    "description": "Object-Graph Map",
    "lineNumber": 15,
    "unknown": [
      {
        "tagName": "@class",
        "tagValue": "Graph"
      }
    ],
    "interface": false
  },
  {
    "__docId__": 77,
    "kind": "get",
    "name": "TYPE_NODE",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Graph.js~Graph.TYPE_NODE",
    "access": "public",
    "description": null,
    "lineNumber": 17,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 78,
    "kind": "get",
    "name": "TYPE_RELATIONSHIP",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Graph.js~Graph.TYPE_RELATIONSHIP",
    "access": "public",
    "description": null,
    "lineNumber": 22,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 79,
    "kind": "get",
    "name": "TYPE_INTEGER",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Graph.js~Graph.TYPE_INTEGER",
    "access": "public",
    "description": null,
    "lineNumber": 27,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 80,
    "kind": "get",
    "name": "TYPE_ARRAY",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Graph.js~Graph.TYPE_ARRAY",
    "access": "public",
    "description": null,
    "lineNumber": 32,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 81,
    "kind": "get",
    "name": "db",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Graph.js~Graph.db",
    "access": "public",
    "description": "Get a database instance.",
    "lineNumber": 43,
    "unknown": [
      {
        "tagName": "@readonly",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 82,
    "kind": "member",
    "name": "[_db]",
    "memberof": "lib/Graph.js~Graph",
    "static": true,
    "longname": "lib/Graph.js~Graph.[_db]",
    "access": "private",
    "description": "",
    "lineNumber": 48,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 83,
    "kind": "get",
    "name": "Node",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Graph.js~Graph.Node",
    "access": "public",
    "description": null,
    "lineNumber": 53,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 84,
    "kind": "member",
    "name": "[_Node]",
    "memberof": "lib/Graph.js~Graph",
    "static": true,
    "longname": "lib/Graph.js~Graph.[_Node]",
    "access": "private",
    "description": "",
    "lineNumber": 60,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 85,
    "kind": "get",
    "name": "Relationship",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Graph.js~Graph.Relationship",
    "access": "public",
    "description": null,
    "lineNumber": 66,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 86,
    "kind": "member",
    "name": "[_Relationship]",
    "memberof": "lib/Graph.js~Graph",
    "static": true,
    "longname": "lib/Graph.js~Graph.[_Relationship]",
    "access": "private",
    "description": "",
    "lineNumber": 73,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 87,
    "kind": "get",
    "name": "NodeCollection",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Graph.js~Graph.NodeCollection",
    "access": "public",
    "description": null,
    "lineNumber": 79,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 88,
    "kind": "member",
    "name": "[_NodeCollection]",
    "memberof": "lib/Graph.js~Graph",
    "static": true,
    "longname": "lib/Graph.js~Graph.[_NodeCollection]",
    "access": "private",
    "description": "",
    "lineNumber": 86,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 89,
    "kind": "method",
    "name": "build",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Graph.js~Graph.build",
    "access": "public",
    "description": "Build a graph from query results.\nMap variables returned from the query to Nodes",
    "lineNumber": 103,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Graph} The resulting graph."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "query",
        "description": "The search query."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "parameters",
        "description": "The parameters used in the search query."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "models",
        "description": "variables and Node models as key-value pairs."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "null",
        "defaultRaw": null,
        "name": "links",
        "description": "virtual relationships between records"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Graph"
      ],
      "spread": false,
      "description": "The resulting graph."
    }
  },
  {
    "__docId__": 90,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Graph.js~Graph#constructor",
    "access": "public",
    "description": "Creates an instance of Graph.",
    "lineNumber": 119,
    "params": [
      {
        "nullable": null,
        "types": [
          "neo4j.Result"
        ],
        "spread": false,
        "optional": false,
        "name": "result",
        "description": "Result of a query."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "models",
        "description": "variables and Node models as key-value pairs."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "null",
        "defaultRaw": null,
        "name": "links",
        "description": "virtual relationships between records"
      }
    ]
  },
  {
    "__docId__": 91,
    "kind": "member",
    "name": "nodes",
    "memberof": "lib/Graph.js~Graph",
    "static": false,
    "longname": "lib/Graph.js~Graph#nodes",
    "access": "public",
    "description": null,
    "lineNumber": 121,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 92,
    "kind": "member",
    "name": "relationships",
    "memberof": "lib/Graph.js~Graph",
    "static": false,
    "longname": "lib/Graph.js~Graph#relationships",
    "access": "public",
    "description": null,
    "lineNumber": 122,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 93,
    "kind": "member",
    "name": "index",
    "memberof": "lib/Graph.js~Graph",
    "static": false,
    "longname": "lib/Graph.js~Graph#index",
    "access": "public",
    "description": null,
    "lineNumber": 123,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 94,
    "kind": "member",
    "name": "references",
    "memberof": "lib/Graph.js~Graph",
    "static": false,
    "longname": "lib/Graph.js~Graph#references",
    "access": "public",
    "description": null,
    "lineNumber": 124,
    "undocument": true,
    "type": {
      "types": [
        "{}"
      ]
    }
  },
  {
    "__docId__": 95,
    "kind": "member",
    "name": "models",
    "memberof": "lib/Graph.js~Graph",
    "static": false,
    "longname": "lib/Graph.js~Graph#models",
    "access": "public",
    "description": null,
    "lineNumber": 125,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 96,
    "kind": "member",
    "name": "links",
    "memberof": "lib/Graph.js~Graph",
    "static": false,
    "longname": "lib/Graph.js~Graph#links",
    "access": "public",
    "description": null,
    "lineNumber": 126,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 97,
    "kind": "method",
    "name": "run",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Graph.js~Graph#run",
    "access": "public",
    "description": "Run a Cypher query and add the result to the current Graph instance",
    "lineNumber": 143,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Promise} A promise"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "query",
        "description": "A Cypher query"
      },
      {
        "nullable": null,
        "types": [
          "Object"
        ],
        "spread": false,
        "optional": false,
        "name": "parameters",
        "description": "Parameters used in the query"
      },
      {
        "nullable": null,
        "types": [
          "Object"
        ],
        "spread": false,
        "optional": true,
        "name": "models",
        "description": "Map variables to Models"
      },
      {
        "nullable": null,
        "types": [
          "Object"
        ],
        "spread": false,
        "optional": true,
        "name": "links",
        "description": "Link results to a specific Model"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise"
      ],
      "spread": false,
      "description": "A promise"
    }
  },
  {
    "__docId__": 99,
    "kind": "method",
    "name": "addRecords",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Graph.js~Graph#addRecords",
    "access": "public",
    "description": "Add records to the graph",
    "lineNumber": 165,
    "params": [
      {
        "nullable": null,
        "types": [
          "neo4j.Record[]"
        ],
        "spread": false,
        "optional": false,
        "name": "records",
        "description": "Neo4j Records"
      }
    ],
    "return": null
  },
  {
    "__docId__": 100,
    "kind": "method",
    "name": "addLinks",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Graph.js~Graph#addLinks",
    "access": "public",
    "description": "Link record items",
    "lineNumber": 183,
    "params": [
      {
        "nullable": null,
        "types": [
          "neo4j.Record"
        ],
        "spread": false,
        "optional": false,
        "name": "record",
        "description": "Neo4j Record"
      }
    ],
    "return": null
  },
  {
    "__docId__": 101,
    "kind": "method",
    "name": "add",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Graph.js~Graph#add",
    "access": "public",
    "description": "Add one or more entities to the graph",
    "lineNumber": 226,
    "params": [
      {
        "nullable": null,
        "types": [
          "neo4j.types.Node",
          "neo4j.types.Node[]",
          "neo4j.types.Relationship",
          "neo4j.types.Relationship[]"
        ],
        "spread": false,
        "optional": false,
        "name": "entity",
        "description": "One or more entities"
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "key",
        "description": "The key associated with this"
      }
    ],
    "return": null
  },
  {
    "__docId__": 102,
    "kind": "method",
    "name": "setRelationshipsIndex",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Graph.js~Graph#setRelationshipsIndex",
    "access": "public",
    "description": null,
    "lineNumber": 281,
    "undocument": true,
    "params": [
      {
        "name": "entity",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 103,
    "kind": "method",
    "name": "remove",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Graph.js~Graph#remove",
    "access": "public",
    "description": "Remove one or more entities from the graph",
    "lineNumber": 308,
    "params": [
      {
        "nullable": null,
        "types": [
          "neo4j.types.Node",
          "neo4j.types.Node[]",
          "neo4j.types.Relationship",
          "neo4j.types.Relationship[]",
          "Node",
          "Node[]",
          "Relationship",
          "Relationship[]"
        ],
        "spread": false,
        "optional": false,
        "name": "obj",
        "description": "One or more objects"
      }
    ],
    "return": null
  },
  {
    "__docId__": 104,
    "kind": "method",
    "name": "getEntity",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Graph.js~Graph.getEntity",
    "access": "public",
    "description": "Get the Neo4j node entity",
    "lineNumber": 339,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{neo4j.types.Node} The Neo4j Node entity"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Node",
          "neo4j.types.Node",
          "Object"
        ],
        "spread": false,
        "optional": false,
        "name": "subject",
        "description": "Anything that could represent a node"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "neo4j.types.Node"
      ],
      "spread": false,
      "description": "The Neo4j Node entity"
    }
  },
  {
    "__docId__": 105,
    "kind": "method",
    "name": "typeOf",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Graph.js~Graph.typeOf",
    "access": "public",
    "description": "Get the type of the entity",
    "lineNumber": 365,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} Graph.TYPE_NODE, Graph.TYPE_RELATIONSHIP, Graph.TYPE_INTEGER or native JS type"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "any"
        ],
        "spread": false,
        "optional": false,
        "name": "entity",
        "description": "Entity object"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "Graph.TYPE_NODE, Graph.TYPE_RELATIONSHIP, Graph.TYPE_INTEGER or native JS type"
    }
  },
  {
    "__docId__": 106,
    "kind": "method",
    "name": "getId",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Graph.js~Graph.getId",
    "access": "public",
    "description": "Get Neo4j Node id",
    "lineNumber": 396,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Number} The Neo4j Node ID as number"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Node",
          "neo4j.types.Node",
          "Object"
        ],
        "spread": false,
        "optional": false,
        "name": "subject",
        "description": "Anything that could represent a node"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Number"
      ],
      "spread": false,
      "description": "The Neo4j Node ID as number"
    }
  },
  {
    "__docId__": 107,
    "kind": "method",
    "name": "getMap",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Graph.js~Graph#getMap",
    "access": "public",
    "description": "Get the map used for the entity",
    "lineNumber": 422,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Map} The entity map"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "any"
        ],
        "spread": false,
        "optional": false,
        "name": "entity",
        "description": "Entity object"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Map"
      ],
      "spread": false,
      "description": "The entity map"
    }
  },
  {
    "__docId__": 108,
    "kind": "method",
    "name": "getRelationship",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Graph.js~Graph#getRelationship",
    "access": "public",
    "description": "Get Relationship from the graph",
    "lineNumber": 447,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Relationship} Relationship or null if no match was found"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Node"
        ],
        "spread": false,
        "optional": false,
        "name": "start",
        "description": "Start node"
      },
      {
        "nullable": null,
        "types": [
          "Node"
        ],
        "spread": false,
        "optional": false,
        "name": "end",
        "description": "End node"
      },
      {
        "nullable": null,
        "types": [
          "Function"
        ],
        "spread": false,
        "optional": false,
        "name": "$Relationship",
        "description": "Relationship class"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Relationship"
      ],
      "spread": false,
      "description": "Relationship or null if no match was found"
    }
  },
  {
    "__docId__": 109,
    "kind": "method",
    "name": "getRelated",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Graph.js~Graph#getRelated",
    "access": "public",
    "description": "Get related nodes",
    "lineNumber": 515,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Node[]} Related nodes"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Node"
        ],
        "spread": false,
        "optional": false,
        "name": "node",
        "description": "Start node"
      },
      {
        "nullable": null,
        "types": [
          "Function"
        ],
        "spread": false,
        "optional": false,
        "name": "$Relationship",
        "description": "Relationship class"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Node[]"
      ],
      "spread": false,
      "description": "Related nodes"
    }
  },
  {
    "__docId__": 110,
    "kind": "method",
    "name": "getNodeModel",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Graph.js~Graph#getNodeModel",
    "access": "public",
    "description": "Wrap a Neo4j node in a specified Node model",
    "lineNumber": 563,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Node} The Node model"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Number",
          "neo4j.integer"
        ],
        "spread": false,
        "optional": false,
        "name": "id",
        "description": "The Neo4j Node ID"
      },
      {
        "nullable": null,
        "types": [
          "Function<Node>"
        ],
        "spread": false,
        "optional": false,
        "name": "$Node",
        "description": "The Node Model Class"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Node"
      ],
      "spread": false,
      "description": "The Node model"
    }
  },
  {
    "__docId__": 111,
    "kind": "method",
    "name": "getNodes",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Graph.js~Graph#getNodes",
    "access": "public",
    "description": "Get all Nodes for a reference used in the Cypher query",
    "lineNumber": 600,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{array} An array of nodes"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "reference",
        "description": "The reference"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "array"
      ],
      "spread": false,
      "description": "An array of nodes"
    }
  },
  {
    "__docId__": 112,
    "kind": "method",
    "name": "getLinked",
    "memberof": "lib/Graph.js~Graph",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Graph.js~Graph#getLinked",
    "access": "public",
    "description": "Get linked results mapped to Models",
    "lineNumber": 626,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{any} The linked result"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Node"
        ],
        "spread": false,
        "optional": false,
        "name": "node",
        "description": "The start node"
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "name",
        "description": "The name of the link"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "any"
      ],
      "spread": false,
      "description": "The linked result"
    }
  },
  {
    "__docId__": 113,
    "kind": "file",
    "name": "lib/Node.js",
    "content": "'use strict'\n\nconst neo4j = require('neo4j-driver/lib/v1')\nconst { Model } = require('maggoo')\nconst NodeCollection = require('./NodeCollection')\nconst RelatedNode = require('./RelatedNode')\nconst RelatedNodeCollection = require('./RelatedNodeCollection')\nconst Relationship = require('./Relationship')\nconst Graph = require('./Graph')\nconst DB = require('./DB')\nconst shortid = require('shortid')\nconst merge = require('deepmerge')\n\n\n/**\n * Query options object\n * @typedef {Object} QueryOptions\n * @property {Object.<String, *>} [parameters] - Parameters used in the query.\n * @property {String} [variable] - The variable used to identify the Node in the query, 'n' by default.\n * @property {Array} [variables] - All variables used in the query that should be added to the results.\n * @property {String|Array} [where] - The where clause, arrays are joined by the 'AND' operator.\n * @property {Number} [limit] - The maximum number of results to be returned\n * @property {String} [with] - The name of relationship to include, use the dot-notation to include multiple levels\n * @property {Array} [with] - An array of names of relationships to include\n * @property {Object.<String, Boolean|Object>} [with] - Relationships to include (true) or exclude (false) or filter(object)\n * @property {Object.<String, NodeLink>} [links] - Linked results to connect to this model\n */\n\n/**\n * @typedef {Object} NodeLink\n * @property {String} [start] Reference to the start node (defaults to 'n')\n * @property {String} end Reference to the end node\n * @property {Boolean} [singular] Only one result per record is returned (eg. when using scalar values or by using `collect`)\n */\n\n/**\n * Relationship definition object\n * @typedef {object} RelationshipDefinition\n * @property {Node|function} Model - {@link Relationship.Model}\n * @property {string} type - {@link Relationship.type}\n * @property {string} direction - {@link Relationship.direction}\n * @property {boolean} singular - {@link Relationship.singular}\n */\n\nconst REGEX_LEVEL_SPLIT = /\\.(.*)/\nconst REGEX_INDEX = /([^(]*)\\(?([^)]*)\\)?/i\n\n// Private\nconst _related = Symbol('related')\nconst _linked = Symbol('linked')\nconst _labels = Symbol('labels')\n\n/**\n * Class representing a single node\n */\nclass Node extends Model\n{\n\t/**\n\t * Creates an instance of Node.\n\t *\n\t * @param {Node|neo4j.types.Node} node Node data object or neo4j Node\n\t * @param {Graph} [graph] The current graph\n\t */\n\tconstructor(node, graph)\n\t{\n\t\tif (node instanceof neo4j.types.Node)\n\t\t{\n\t\t\tsuper(node.properties)\n\n\t\t\tthis.$labels = node.labels\n\n\t\t\t/**\n\t\t\t * @type {neo4.Node} The original node data from the graph\n\t\t\t */\n\t\t\tthis.$entity = node\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsuper(node)\n\t\t}\n\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tthis[_related] = {}\n\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tthis[_linked] = {}\n\n\t\t/**\n\t\t * @type {Graph}\n\t\t */\n\t\tthis.$graph = graph\n\t}\n\n\t/**\n\t * ID generator, uses ShortId by default\n\t * @returns {string} ID\n\t */\n\tstatic uuid()\n\t{\n\t\treturn shortid.generate()\n\t}\n\n\tstatic addIndex(property, now = false)\n\t{\n\t\treturn DB.addIndex(this.prototype.$type, property, now)\n\t}\n\n\tstatic addUnique(property, now = false)\n\t{\n\t\treturn DB.addUnique(this.prototype.$type, property, now)\n\t}\n\n\tstatic async dropIndex(property)\n\t{\n\t\tawait DB.dropIndex(this.prototype.$type, property)\n\t}\n\n\tstatic async dropUnique(property)\n\t{\n\t\tawait DB.dropUnique(this.prototype.$type, property)\n\t}\n\n\tstatic get Collection()\n\t{\n\t\tconst self = this\n\n\t\treturn class extends NodeCollection\n\t\t{\n\t\t\tconstructor(items)\n\t\t\t{\n\t\t\t\tsuper(self, items)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * The node ID.\n\t * This will be automatically generated when the node is saved\n\t *\n\t * @type {string}\n\t */\n\tget id()\n\t{\n\t\treturn this.$data.id\n\t}\n\n\tset id(value)\n\t{\n\t\tthis.$data.id = value\n\t}\n\n\t/**\n\t * The neo4j entity ID.\n\t * Note that this could change over time, use id instead.\n\t *\n\t * @readonly\n\t * @type {number}\n\t */\n\tget $id()\n\t{\n\t\treturn this.$entity ? this.$entity.identity.toNumber() : null\n\t}\n\n\t/**\n\t * Whether or not the node is already stored in the graph database.\n\t *\n\t * @type {boolean}\n\t */\n\tget $new()\n\t{\n\t\treturn !this.$entity\n\t}\n\n\t/**\n\t * Whether or not the Node has changed properties.\n\t *\n\t * @type {boolean}\n\t */\n\tget $dirty()\n\t{\n\t\treturn this.$new || super.$dirty\n\t}\n\n\t/**\n\t * Set property value\n\t *\n\t * @param {string} key Property name\n\t * @param {any} value Property value\n\t */\n\tsetProperty(key, value)\n\t{\n\t\tif (value && value.toNumber)\n\t\t{\n\t\t\tvalue = value.toNumber()\n\t\t}\n\n\t\tsuper.setProperty(key, value)\n\t}\n\n\t/**\n\t * Get a Node property or related node(s).\n\t *\n\t * @param {string} key The name of the property or relationship\n\t * @returns {any|RelatedNodeCollection} The value or related node(s)\n\t */\n\tget(key)\n\t{\n\t\tif (key in this.constructor.relationships)\n\t\t{\n\t\t\treturn this.getRelated(key)\n\t\t}\n\n\t\tconst value = super.get(key)\n\n\t\tif (typeof value === 'undefined')\n\t\t{\n\t\t\treturn this.getLinked(key)\n\t\t}\n\n\t\treturn value\n\t}\n\n\t/**\n\t * Set a Node property or related node(s).\n\t *\n\t * @param {string} key The name of the property or relationship\n\t * @param {any} value The value or related node(s)\n\t * @returns {boolean} Whether or not the property was successfully set\n\t */\n\tset(key, value)\n\t{\n\t\tif (key in this.constructor.relationships)\n\t\t{\n\t\t\treturn this.setRelated(key, value)\n\t\t}\n\n\t\treturn super.set(key, value)\n\t}\n\n\thas(key)\n\t{\n\t\t// TODO: check related / linked\n\n\t\treturn super.has(key)\n\t}\n\n\t/**\n\t * Definitions of the relationships for this Node\n\t *\n\t * @member\n\t * @readonly\n\t * @type {object.<string, RelationshipDefinition>}\n\t */\n\tstatic get relationships()\n\t{\n\t\treturn {}\n\t}\n\n\t/**\n\t * Get a Relationship class by name.\n\t *\n\t * @param {string} name The name of the relationship\n\t * @returns {Relationship} The Relationship class\n\t */\n\tstatic getRelationship(name)\n\t{\n\t\tconst definition = this.relationships[name]\n\n\t\tif (definition.prototype instanceof Relationship)\n\t\t{\n\t\t\treturn definition\n\t\t}\n\n\t\tclass $Relationship extends Relationship {}\n\n\t\tObject.assign($Relationship, definition)\n\n\t\treturn $Relationship\n\t}\n\n\t/**\n\t * Get a Relationship class by name.\n\t *\n\t * @param {string} name The name of the relationship\n\t * @returns {Relationship} The Relationship class\n\t */\n\tgetRelationship(name)\n\t{\n\t\treturn this.constructor.getRelationship(name)\n\t}\n\n\t/**\n\t * Get related node(s).\n\t *\n\t * @param {string} name The name of the relationship\n\t * @returns {RelatedNodeCollection} The related node(s)\n\t */\n\tgetRelated(name)\n\t{\n\t\tconst $Relationship = this.getRelationship(name)\n\n\t\tif (!this[_related][name])\n\t\t{\n\t\t\tconst nodes = this.$graph ? this.$graph.getRelated(this, $Relationship) : []\n\t\t\tconst related = new RelatedNodeCollection($Relationship, nodes, this)\n\n\t\t\tthis[_related][name] = related\n\t\t}\n\n\t\tconst result = this[_related][name]\n\n\t\tif (!result.length && $Relationship.singular)\n\t\t{\n\t\t\treturn null\n\t\t}\n\n\t\treturn $Relationship.singular ? result[0] : result\n\t}\n\n\t/**\n\t * Get linked results.\n\t *\n\t * @param {string} name The name of the link\n\t * @returns {*} The related node(s) / value(s) or null if none is found\n\t */\n\tgetLinked(name)\n\t{\n\t\tif (!this.$graph)\n\t\t{\n\t\t\treturn null\n\t\t}\n\n\t\tif (!this.$graph.links || !(name in this.$graph.links))\n\t\t{\n\t\t\treturn null\n\t\t}\n\n\t\tif (!this[_linked][name])\n\t\t{\n\t\t\tconst linked = this.$graph ? this.$graph.getLinked(this, name) : []\n\n\t\t\tthis[_linked][name] = linked\n\t\t}\n\n\t\treturn this[_linked][name]\n\t}\n\n\t/**\n\t * Add related node(s).\n\t * Existing nodes will not be overwritten unless the relationship is singular.\n\t *\n\t * @param {string} name The name of the relationship\n\t * @param {Node|NodeCollection|Node[]} node Node(s)\n\t * @param {Object} [properties={}] Properties to set on the relationship(s)\n\t */\n\taddRelated(name, node, properties = {})\n\t{\n\t\tthis.setRelated(name, node, properties, false)\n\t}\n\n\t/**\n\t * Set related node(s).\n\t *\n\t * @param {string} name The name of the relationship\n\t * @param {Node|NodeCollection|Node[]} node Node(s)\n\t * @param {any} [properties={}] Properties to set on the relationship(s)\n\t * @param {boolean} [overwrite=true] If set to false existing nodes will not be overwritten unless the relationship is singular\n\t */\n\tsetRelated(name, node, properties = {}, overwrite = true)\n\t{\n\t\tconst $Relationship = this.getRelationship(name)\n\n\t\tlet result = null\n\n\t\tif ($Relationship.singular)\n\t\t{\n\t\t\tresult = new RelatedNodeCollection($Relationship, [node], this)\n\t\t\tresult[0].$rel.setProperties(properties)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst nodes = node instanceof Array ? node : [node]\n\t\t\tconst items = []\n\n\t\t\tfor (node of nodes)\n\t\t\t{\n\t\t\t\tconst item = new RelatedNode($Relationship, this, node, properties, this.$graph)\n\n\t\t\t\titems.push(item)\n\t\t\t}\n\n\t\t\tif (overwrite)\n\t\t\t{\n\t\t\t\tresult = new RelatedNodeCollection($Relationship, items, this)\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult = this.getRelated(name)\n\t\t\t\tresult.push(...items)\n\t\t\t}\n\t\t}\n\n\t\tthis.setChanged(name, result)\n\n\t\tthis[_related][name] = result\n\t}\n\n\tclearCachedRelationships(relationships = null)\n\t{\n\t\tif (relationships === null)\n\t\t{\n\t\t\trelationships = Object.keys(this.constructor.relationships)\n\t\t}\n\n\t\trelationships = this.constructor.normalizeRelationshipLevels(relationships)\n\n\t\tfor (const relationship of Object.keys(relationships))\n\t\t{\n\t\t\tconst filters = relationships[relationship]\n\n\t\t\tif (this[_related][relationship] && filters.with)\n\t\t\t{\n\t\t\t\tthis[_related][relationship].clearCachedRelationships(filters.with)\n\t\t\t}\n\n\t\t\tdelete this[_related][relationship]\n\t\t}\n\t}\n\n\tstatic get labels()\n\t{\n\t\tconst labels = [this.name]\n\n\t\tif (this === Node)\n\t\t{\n\t\t\treturn labels\n\t\t}\n\n\t\tlet parent = Object.getPrototypeOf(this)\n\n\t\twhile (parent !== Node && Reflect.has(parent, 'labels'))\n\t\t{\n\t\t\tconst $labels = Reflect.get(parent, 'labels', parent)\n\n\t\t\tlabels.push(...$labels)\n\t\t\tparent = Object.getPrototypeOf(parent)\n\t\t}\n\n\t\treturn labels\n\t}\n\n\tstatic get baseLabel()\n\t{\n\t\treturn this.labels[0]\n\t}\n\n\tget $base()\n\t{\n\t\treturn this.constructor.baseLabel\n\t}\n\n\t/**\n\t * Node labels. Will be added the node in the graph database.\n\t * By default it uses the constructor name.\n\t *\n\t * @type {Array}\n\t */\n\tget $labels()\n\t{\n\t\tif (this[_labels])\n\t\t{\n\t\t\treturn this[_labels]\n\t\t}\n\n\t\tconst labels = this.constructor.labels\n\n\t\t// Mark as private to exclude from esdoc\n\t\t/** @private */\n\t\tthis[_labels] = labels\n\n\t\treturn labels\n\t}\n\n\t/**\n\t * Node labels. Will be added the node in the graph database.\n\t * By default it uses the constructor name.\n\t *\n\t * @type {Array}\n\t * @param {Array} labels Labels\n\t */\n\tset $labels(labels)\n\t{\n\t\t// Mark as private to exclude from esdoc\n\t\t/** @private */\n\t\tthis[_labels] = labels\n\t}\n\n\t/* * * * * * * * * * * * * * * *\n\t *        WRITE METHODS        *\n\t * * * * * * * * * * * * * * * */\n\n\n\t/**\n\t * Save the Node to the graph database.\n\t *\n\t * @param {boolean|string[]} [deep=false] If true save all related nodes, or specific relationships defined as an array of strings.\n\t * @param {any} [tx=null] The current database transaction\n\t */\n\tasync save(deep = false, tx = null)\n\t{\n\t\t// Prevent infinite loops in circular graphs\n\t\tif (tx && tx.$nodes.includes(this.id))\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tlet session = null\n\n\t\tif (!tx)\n\t\t{\n\t\t\ttx = DB.beginTransaction()\n\t\t\tsession = tx.session\n\t\t}\n\n\t\tthis.id = this.id || this.constructor.uuid()\n\n\t\ttx.$nodes.push(this.id)\n\n\t\tif (this.$dirty)\n\t\t{\n\t\t\tconst properties = Object.assign({}, this.$data)\n\t\t\tconst parameters = { properties }\n\n\t\t\tlet query = ''\n\n\t\t\tparameters.id = this.id\n\n\t\t\tquery += `MERGE (n:${ this.$base } {id: {id}})`\n\t\t\tquery += '\\n'\n\n\t\t\t// TODO: remove properties that were explicitly deleted\n\n\t\t\tquery += `\n\t\t\t\tSET n:${ this.$labels.join(':') }\n\t\t\t\tSET n += {properties}\n\t\t\t\tRETURN n\n\t\t\t`\n\n\t\t\tconst result = await tx.run(query, parameters).then(r => r)\n\n\t\t\tthis.$entity = result.records[0].get('n')\n\t\t\tthis.reset()\n\t\t}\n\n\t\tif (deep)\n\t\t{\n\t\t\tconst relationships = typeof deep === 'boolean' ? null : deep\n\n\t\t\tawait this.saveRelated(relationships, tx)\n\t\t}\n\n\t\tif (session)\n\t\t{\n\t\t\tawait tx.commit().then(r => r)\n\n\t\t\tsession.close()\n\t\t}\n\t}\n\n\t/**\n\t * Save related nodes and their relationships\n\t *\n\t * @param {Array} [keys] The relationships to be saved (all by default)\n\t * @param {Transaction} [tx] The current database transaction\n\t */\n\tasync saveRelated(keys = null, tx = null)\n\t{\n\t\tlet relationships = keys || Object.keys(this.constructor.relationships)\n\n\t\tif (typeof relationships === 'string')\n\t\t{\n\t\t\trelationships = [relationships]\n\t\t}\n\n\t\tfor (const key of relationships)\n\t\t{\n\t\t\tlet nodes = this.getRelated(key)\n\n\t\t\tif (nodes && !(nodes instanceof Array))\n\t\t\t{\n\t\t\t\tnodes = [nodes]\n\t\t\t}\n\n\t\t\tif (!nodes || !nodes.length)\n\t\t\t{\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tfor (const node of nodes)\n\t\t\t{\n\t\t\t\tconst deep = keys === null\n\n\t\t\t\tawait node.save(deep, tx)\n\n\t\t\t\tif (node.$rel.$dirty)\n\t\t\t\t{\n\t\t\t\t\tawait node.$rel.save(tx)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Delete node from the graph database\n\t *\n\t * @param {boolean} [deep=false] Delete related nodes\n\t * @param {Transaction} [tx=null] The current database transaction\n\t */\n\tasync delete(deep = false, tx = null)\n\t{\n\t\tif (!this.id)\n\t\t{\n\t\t\tthrow new Error('Can not delete a node without ID')\n\t\t}\n\n\t\t// Prevent infinite loops in circular graphs\n\t\tif (tx && tx.$nodes.includes(this.id))\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tlet session = null\n\n\t\tif (!tx)\n\t\t{\n\t\t\ttx = DB.beginTransaction()\n\t\t\tsession = tx.session\n\t\t\ttx.$nodes = []\n\t\t}\n\n\t\ttx.$nodes.push(this.id)\n\n\t\tconst query = `\n\t\t\tMATCH (n:${ this.$base })\n\t\t\tWHERE n.id = {id}\n\t\t\tDETACH DELETE n\n\t\t`\n\n\t\tconst parameters = { id: this.id }\n\n\t\tawait tx.run(query, parameters).then(r => r)\n\n\t\tif (deep)\n\t\t{\n\t\t\tawait this.deleteRelated(tx)\n\t\t}\n\n\t\tif (this.$graph)\n\t\t{\n\t\t\tthis.$graph.remove(this.$entity)\n\t\t}\n\n\t\tthis.$entity = null\n\t\tthis.$data.id = null\n\n\t\tif (session)\n\t\t{\n\t\t\tawait tx.commit().then(r => r)\n\n\t\t\tsession.close()\n\t\t}\n\t}\n\n\t/**\n\t * Delete related nodes and their relationships\n\t *\n\t * @param {Transaction} [tx] The current database transaction\n\t */\n\tasync deleteRelated(tx = null)\n\t{\n\t\tfor (const key of Object.keys(this.constructor.relationships))\n\t\t{\n\t\t\tconst $Relationship = this.getRelationship(key)\n\t\t\tlet nodes = this.getRelated(key)\n\n\t\t\tif ($Relationship.singular)\n\t\t\t{\n\t\t\t\tnodes = nodes ? [nodes] : []\n\t\t\t}\n\n\t\t\tfor (const node of nodes)\n\t\t\t{\n\t\t\t\tawait node.delete(true, tx)\n\t\t\t}\n\t\t}\n\t}\n\n\tasync addLabel(label, tx = null)\n\t{\n\t\tawait this.addLabels(label, tx)\n\t}\n\n\tasync addLabels(labels, tx = null)\n\t{\n\t\tlet query = `\n\t\t\tMATCH (n:${ this.$base })\n\t\t\tWHERE n.id = {id}\n\t\t`\n\n\t\tif (!Array.isArray(labels))\n\t\t{\n\t\t\tlabels = [labels]\n\t\t}\n\n\t\tfor (const label of labels)\n\t\t{\n\t\t\tquery += `\n\t\t\t\tSET n:${ label }\n\t\t\t`\n\t\t}\n\n\t\tconst parameters = { id: this.id }\n\n\t\tlet session = null\n\n\t\tif (!tx)\n\t\t{\n\t\t\ttx = DB.beginTransaction()\n\t\t\tsession = tx.session\n\t\t}\n\n\t\tawait tx.run(query, parameters).then(r => r)\n\n\t\tconst added = labels.filter(label => !this.$labels.includes(label))\n\n\t\tthis.$labels.push(...added)\n\n\t\tif (session)\n\t\t{\n\t\t\tawait tx.commit().then(r => r)\n\n\t\t\tsession.close()\n\t\t}\n\t}\n\n\tasync removeLabel(label, tx = null)\n\t{\n\t\tawait this.removeLabels(label, tx)\n\t}\n\n\tasync removeLabels(labels, tx = null)\n\t{\n\t\tlet query = `\n\t\t\tMATCH (n:${ this.$base })\n\t\t\tWHERE n.id = {id}\n\t\t`\n\n\t\tif (!Array.isArray(labels))\n\t\t{\n\t\t\tlabels = [labels]\n\t\t}\n\n\t\tfor (const label of labels)\n\t\t{\n\t\t\tquery += `\n\t\t\t\tREMOVE n:${ label }\n\t\t\t`\n\t\t}\n\n\t\tconst parameters = { id: this.id }\n\n\t\tlet session = null\n\n\t\tif (!tx)\n\t\t{\n\t\t\ttx = DB.beginTransaction()\n\t\t\tsession = tx.session\n\t\t}\n\n\t\tawait tx.run(query, parameters).then(r => r)\n\n\t\tthis.$labels = this.$labels.filter(label => !labels.includes(label))\n\n\t\tif (session)\n\t\t{\n\t\t\tawait tx.commit().then(r => r)\n\n\t\t\tsession.close()\n\t\t}\n\t}\n\n\n\t/* * * * * * * * * * * * * * * *\n\t *        READ METHODS         *\n\t * * * * * * * * * * * * * * * */\n\n\n\t/**\n\t * Default values for query options\n\t */\n\tstatic get queryDefaults()\n\t{\n\t\treturn {\n\t\t\tparameters: {},\n\t\t\tvariable: 'n',\n\t\t\tvariables: [],\n\t\t\tlinks: null\n\t\t}\n\t}\n\n\t/**\n\t * Fetch a single Node\n\t *\n\t * @param {string|object} filters Filter object or Node id\n\t * @param {QueryOptions} [o={}] Query options\n\t * @returns {Node} Result\n\t *\n\t * @example\n\t * const node = await Node.get('foo')\n\t *\n\t * @example\n\t * const node = await Node.get({ id: 'foo' })\n\t */\n\tstatic async get(filters, o = {})\n\t{\n\t\to.singular = true\n\n\t\treturn this.find(filters, o)\n\t}\n\n\t/**\n\t * Fetch Nodes\n\t *\n\t * @param {QueryOptions} o Query options\n\t * @return {NodeCollection} Results\n\t *\n\t * @example\n\t * const nodes = await Node.all({ limit: 10 })\n\t */\n\tstatic async all(o)\n\t{\n\t\treturn this.find(null, o)\n\t}\n\n\t/**\n\t * Use a query statement to search for Nodes\n\t * By default returns results for 'n' as Node collection\n\t *\n\t * @param {string} query A search query\n\t * @param {object} [parameters={}] Parameters used in query\n\t * @param {QueryOptions} [o={}] Query options\n\t * @returns {NodeCollection} Results\n\t *\n\t * @example\n\t * const nodes = await Node.query(`\n\t *     MATCH (n:Node)\n\t *     WHERE n.foo > {foo}\n\t * `, { foo: 1 })\n\t */\n\tstatic async query(query, parameters = {}, o = {})\n\t{\n\t\to = merge(o, { query, parameters })\n\n\t\treturn this.find(null, o)\n\t}\n\n\t/**\n\t * Use a query statement to search for Nodes\n\t * By default returns results for 'n' as Node collection\n\t *\n\t * @param {string} where A where clause\n\t * @param {object} [parameters={}] Parameters used in query\n\t * @param {QueryOptions} [o={}] Query options\n\t * @returns {NodeCollection} Results\n\t *\n\t * @example\n\t * const nodes = await Node.where('n.foo > {foo}', { foo: 1 })\n\t */\n\tstatic async where(where, parameters = {}, o = {})\n\t{\n\t\to = merge(o, { where, parameters })\n\n\t\treturn this.find(null, o)\n\t}\n\n\t/**\n\t * Find Nodes based on filter or Node ID\n\t *\n\t * @param {object|string|number} filters Search filters, Node ID (string), or neo4j node identifier (number)\n\t * @param {QueryOptions} [o={}] Query options\n\t * @returns {NodeCollection} Results\n\t *\n\t * @example\n\t * // Find by ID\n\t * const nodes = Node.find('foo')\n\t *\n\t * @example\n\t * // Find by filter\n\t * const nodes = Node.find({ foo: 1 })\n\t *\n\t * @example\n\t * // Find by filter, with related Nodes\n\t * const nodes = Node.find({ foo: 1 }, { with: 'relatives' })\n\t * nodes[0].relatives\n\t */\n\tstatic async find(filters, o = {})\n\t{\n\t\to = merge(merge({}, this.queryDefaults), o)\n\n\t\tif (!o.variables.includes(o.variable))\n\t\t{\n\t\t\to.variables.push(o.variable)\n\t\t}\n\n\t\tif (o.models)\n\t\t{\n\t\t\tObject.keys(o.models).map(variable =>\n\t\t\t{\n\t\t\t\tif (!o.variables.includes(variable))\n\t\t\t\t{\n\t\t\t\t\to.variables.push(variable)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tif (o.links)\n\t\t{\n\t\t\tObject.keys(o.links).map(variable =>\n\t\t\t{\n\t\t\t\tif (!o.variables.includes(variable))\n\t\t\t\t{\n\t\t\t\t\to.variables.push(variable)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tif (filters)\n\t\t{\n\t\t\to = merge(o, this.parseQueryFilters(filters, o.variable))\n\t\t}\n\n\t\tif (o.with)\n\t\t{\n\t\t\to = merge(o, this.getRelationshipQueryOptions(o.with, o.variables, o.variable))\n\t\t}\n\n\t\tconst query = this.buildQuery(o)\n\n\t\tconst models = o.models || {}\n\n\t\tif (!models[o.variable])\n\t\t{\n\t\t\tmodels[o.variable] = this\n\t\t}\n\n\t\tconst graph = await Graph.build(query, o.parameters, models, o.links)\n\n\t\tconst nodes = graph.getNodes(o.variable)\n\n\t\tif (o.singular)\n\t\t{\n\t\t\treturn nodes && nodes.length ? nodes[0] : null\n\t\t}\n\n\t\treturn new NodeCollection(this, nodes)\n\t}\n\n\t/**\n\t * Build a search query\n\t *\n\t * @param {object} o Query options\n\t * @returns {string} Query string\n\t */\n\tstatic buildQuery(o)\n\t{\n\t\to = merge(this.queryDefaults, o)\n\n\t\tif (o.index && typeof o.index == 'string')\n\t\t{\n\t\t\tlet [, label, property] = o.index.match(REGEX_INDEX)\n\n\t\t\tif (!property)\n\t\t\t{\n\t\t\t\tproperty = label\n\t\t\t\tlabel = this.baseLabel\n\t\t\t}\n\n\t\t\to.index = { label, property }\n\t\t}\n\n\t\t// Build Query\n\t\tlet query = o.query || `MATCH (${ o.variable }:${ o.index ? o.index.label : this.labels.join(':') })\\n`\n\n\t\tif (o.index)\n\t\t{\n\t\t\tquery += `USING INDEX ${ o.variable }:${ o.index.label }(${ o.index.property })\\n`\n\t\t}\n\n\t\t// Define filters\n\t\tif (Array.isArray(o.where) && o.where.length)\n\t\t{\n\t\t\tquery += 'WHERE '\n\t\t\tquery += o.where.join('\\nAND ')\n\t\t\tquery += '\\n'\n\t\t}\n\t\telse if (typeof o.where == 'string')\n\t\t{\n\t\t\tquery += 'WHERE '\n\t\t\tquery += o.where\n\t\t\tquery += '\\n'\n\t\t}\n\n\t\tif (o.matches)\n\t\t{\n\t\t\tquery += o.matches.join('\\n')\n\t\t\tquery += '\\n'\n\t\t}\n\n\t\tif (o.set)\n\t\t{\n\t\t\tconst lines = Array.isArray(o.set) ? o.set : [o.set]\n\n\t\t\tfor (const line of lines)\n\t\t\t{\n\t\t\t\tquery += `SET ${ line }\\n`\n\t\t\t}\n\t\t}\n\n\t\tquery += 'RETURN '\n\n\t\t// Define return values\n\t\tif (o.return)\n\t\t{\n\t\t\tquery += o.return\n\t\t}\n\t\telse\n\t\t{\n\t\t\tquery += o.variables.join(', ')\n\t\t}\n\n\t\tquery += '\\n'\n\n\t\tif (o.orderBy)\n\t\t{\n\t\t\tquery += `ORDER BY ${ o.orderBy }\\n`\n\t\t}\n\n\t\tif (o.skip)\n\t\t{\n\t\t\tquery += `SKIP ${ parseInt(o.skip, 10) }\\n`\n\t\t}\n\n\t\tif (o.limit)\n\t\t{\n\t\t\tquery += `LIMIT ${ parseInt(o.limit, 10) }\\n`\n\t\t}\n\t\telse if (o.singular)\n\t\t{\n\t\t\tquery += 'LIMIT 1\\n'\n\t\t}\n\n\t\treturn query\n\t}\n\n\t/**\n\t * Parse search filters\n\t *\n\t * @param {object|string|number} filters Search filters, Node ID (string), or neo4j node identifier (number)\n\t * @param {string} variable Variable for the current node\n\t * @returns {QueryOptions} Filters options object\n\t */\n\tstatic parseQueryFilters(filters, variable)\n\t{\n\t\tif (typeof filters == 'number')\n\t\t{\n\t\t\tfilters = { $id: filters }\n\t\t}\n\t\telse if (typeof filters == 'string')\n\t\t{\n\t\t\tfilters = { id: filters }\n\t\t}\n\t\telse if (!filters || filters.constructor !== Object)\n\t\t{\n\t\t\tthrow new Error(`Invalid filter object: ${ filters }`)\n\t\t}\n\n\t\tconst o = {\n\t\t\tparameters: {},\n\t\t\twhere: []\n\t\t}\n\n\t\tfor (const [key, value] of Object.entries(filters))\n\t\t{\n\t\t\tconst valueVariable = `${ variable }_${ key }`\n\t\t\tlet condition = ''\n\n\t\t\tif (key === '$id')\n\t\t\t{\n\t\t\t\tcondition += `id(${ variable }) `\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcondition += `${ variable }.${ key } `\n\t\t\t}\n\n\t\t\tif (value instanceof RegExp)\n\t\t\t{\n\t\t\t\tcondition += `=~ {${ valueVariable }}`\n\n\t\t\t\tconst flags = `(?${ value.flags.replace('g', '') })`\n\n\t\t\t\to.parameters[valueVariable] = flags + value.source\n\t\t\t}\n\t\t\telse if (Array.isArray(value))\n\t\t\t{\n\t\t\t\tconst names = []\n\n\t\t\t\tvalue.forEach((v, i) =>\n\t\t\t\t{\n\t\t\t\t\tconst name = valueVariable + i\n\n\t\t\t\t\to.parameters[name] = v\n\t\t\t\t\tnames.push(`{${ name }}`)\n\t\t\t\t})\n\n\t\t\t\tcondition += `IN [${ names.join(', ') }]`\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcondition += `= {${ valueVariable }}`\n\t\t\t\to.parameters[valueVariable] = value\n\t\t\t}\n\n\t\t\to.where.push(condition)\n\t\t}\n\n\t\treturn o\n\t}\n\n\t/**\n\t * Count nodes in graph database\n\t *\n\t * @param {object|string} filters Search filters (object) or where clause (string)\n\t * @param {any} [parameters={}] Parameters used in where clause\n\t * @param {QueryOptions} [o={}] Query options\n\t * @returns {number} Number of nodes\n\t */\n\tstatic async count(filters, parameters = {}, o = {})\n\t{\n\t\to = merge(this.queryDefaults, o)\n\t\to = merge(o, { parameters })\n\n\t\tif (typeof filters == 'string')\n\t\t{\n\t\t\to.where = filters\n\t\t}\n\t\telse if (!!filters && filters.constructor === Object)\n\t\t{\n\t\t\to = merge(o, this.parseQueryFilters(filters, o.variable))\n\t\t}\n\n\t\to.return = `count(distinct(${ o.variable })) as total`\n\n\t\tconst query = this.buildQuery(o)\n\n\t\tconst total = await DB.getScalar(query, o.parameters)\n\n\t\treturn total.toInt()\n\t}\n\n\t/**\n\t * Build query options for related nodes\n\t * Mostly intended for internal usage.\n\t *\n\t * @param {string} levels Filter for related nodes in dot-format (eg. father.children will fetch the related 'father' and its 'children')\n\t * @param {object} variables The variables currently used for building the query\n\t * @param {string} [reference='n'] Reference variable for the current node\n\t * @returns {options} Query options object\n\t * @property {array} matches Optional matches for each relationship\n\t * @property {object} variables The variables currently used for building the query\n\t */\n\tstatic getRelationshipQueryOptions(levels, variables, reference = 'n')\n\t{\n\t\tlet o = {\n\t\t\tmatches: [],\n\t\t\tvariables\n\t\t}\n\n\t\tlevels = this.normalizeRelationshipLevels(levels)\n\n\t\tfor (const name of Object.keys(levels))\n\t\t{\n\t\t\tlet next = null\n\t\t\tconst filters = levels[name]\n\n\t\t\tif (filters.with)\n\t\t\t{\n\t\t\t\tnext = filters.with\n\t\t\t\tdelete filters.with\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnext = null\n\t\t\t}\n\n\t\t\tconst $Relationship = this.getRelationship(name)\n\t\t\tconst nodeVar = `${ reference }_${ name }`\n\t\t\tconst relationshipVar = `${ reference }_r_${ name }`\n\t\t\tconst collectionVar = '_col'\n\n\t\t\tlet query = `OPTIONAL MATCH (${ reference })`\n\n\t\t\tif ($Relationship.direction === Relationship.IN || $Relationship.direction === Relationship.BOTH)\n\t\t\t{\n\t\t\t\tquery += '<'\n\t\t\t}\n\n\t\t\tquery += `-[${ reference }_r_${ name }:${ $Relationship.type }]-`\n\n\t\t\tif ($Relationship.direction === Relationship.OUT || $Relationship.direction === Relationship.BOTH)\n\t\t\t{\n\t\t\t\tquery += '>'\n\t\t\t}\n\n\t\t\tquery += `(${ nodeVar }:${ $Relationship.Model.baseLabel })`\n\n\t\t\tif (!next)\n\t\t\t{\n\t\t\t\to = merge(o, this.parseQueryFilters(filters, nodeVar))\n\n\t\t\t\tif (o.where && o.where.length)\n\t\t\t\t{\n\t\t\t\t\tquery += '\\n'\n\t\t\t\t\tquery += 'WHERE '\n\t\t\t\t\tquery += o.where.join('\\nAND ')\n\n\t\t\t\t\tdelete o.where\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tquery += '\\n'\n\t\t\tquery += `WITH ${ o.variables.join(', ') }, `\n\t\t\tquery += `COLLECT(${ nodeVar }) as ${ nodeVar + collectionVar }, `\n\t\t\tquery += `COLLECT(${ relationshipVar }) as ${ relationshipVar + collectionVar }`\n\n\t\t\to.matches.push(query)\n\n\t\t\to.variables.push(nodeVar + collectionVar)\n\t\t\to.variables.push(relationshipVar + collectionVar)\n\n\t\t\tif (next)\n\t\t\t{\n\t\t\t\tconst nextO = $Relationship.Model.getRelationshipQueryOptions(next, o.variables, nodeVar)\n\n\t\t\t\to = merge(o, nextO)\n\t\t\t}\n\t\t}\n\n\t\treturn o\n\t}\n\n\tstatic normalizeRelationshipLevels(levels)\n\t{\n\t\tif (typeof levels === 'string')\n\t\t{\n\t\t\tconst [current, rest] = levels.split(REGEX_LEVEL_SPLIT)\n\n\t\t\tlevels = { [current]: {} }\n\n\t\t\tif (rest)\n\t\t\t{\n\t\t\t\tlevels[current].with = this.normalizeRelationshipLevels(rest)\n\t\t\t}\n\t\t}\n\t\telse if (Array.isArray(levels))\n\t\t{\n\t\t\tlevels = levels.reduce((obj, current) =>\n\t\t\t{\n\t\t\t\tObject.assign(obj, this.normalizeRelationshipLevels(current))\n\t\t\t\treturn obj\n\t\t\t}, {})\n\t\t}\n\n\t\treturn levels\n\t}\n\n\t/**\n\t * Get a node or a create a new one based on the given properties\n\t *\n\t * @param {object} criteria Specific properties to match\n\t * @param {object} properties Properties to be set on the existing or created node\n\t * @param {QueryOptions} [o={}] Query options\n\t * @returns {Node} Resulting Node\n\t */\n\tstatic async merge(criteria, properties, o = {})\n\t{\n\t\to = merge(merge({}, this.queryDefaults), o)\n\n\t\to.singular = true\n\n\t\tlet query = `MERGE (${ o.variable }:${ this.labels.join(':') }`\n\t\tconst keys = Object.keys(criteria)\n\n\t\tconst queryParameters = {\n\t\t\tcriteria,\n\t\t\tproperties,\n\t\t}\n\n\t\tif (keys.length)\n\t\t{\n\t\t\tconst parameters = []\n\n\t\t\tfor (const key of keys)\n\t\t\t{\n\t\t\t\tparameters.push(`${ key }: {criteria}.${ key }`)\n\t\t\t}\n\n\t\t\tquery += ` {${ parameters.join(', ') }}`\n\t\t}\n\n\t\tquery += ')\\n'\n\n\t\tif (!criteria.id && (!properties || !properties.id))\n\t\t{\n\t\t\tqueryParameters.id = this.uuid()\n\t\t\tquery += `ON CREATE SET ${ o.variable }.id={id}\\n`\n\t\t}\n\n\t\tif (o.onCreate)\n\t\t{\n\t\t\tquery += `ON CREATE ${ o.onCreate }\\n`\n\t\t}\n\n\t\tif (o.onMatch)\n\t\t{\n\t\t\tquery += `ON MATCH ${ o.onMatch }\\n`\n\t\t}\n\n\t\to.set = [`${ o.variable } += {criteria}`]\n\n\t\tif (properties)\n\t\t{\n\t\t\to.set.push(`${ o.variable } += {properties}`)\n\t\t}\n\n\t\treturn await this.query(query, queryParameters, o)\n\t}\n\n\t/**\n\t * Fetch related Nodes connected to the current node.\n\t *\n\t * @param {object|array|string} relationships Similar to 'with' option in #Node.find\n\t * @returns {NodeCollection|Object.<string, NodeCollection>} The related nodes\n\t */\n\tasync fetchRelated(relationships)\n\t{\n\t\tconst $static = this.constructor\n\n\t\tlet o = merge({}, $static.queryDefaults)\n\n\t\to = merge(o, $static.parseQueryFilters({ id: this.id }, o.variable))\n\t\to = merge(o, $static.getRelationshipQueryOptions(relationships, [o.variable]))\n\n\t\tconst query = $static.buildQuery(o)\n\n\t\tawait this.$graph.run(query, o.parameters)\n\n\t\tthis.clearCachedRelationships(relationships)\n\n\t\tconst normalized = $static.normalizeRelationshipLevels(relationships)\n\t\tconst keys = Object.keys(normalized)\n\t\tconst results = {}\n\n\t\tfor (const key of keys)\n\t\t{\n\t\t\tresults[key] = this.getRelated(key)\n\t\t}\n\n\t\tif (typeof relationships === 'string')\n\t\t{\n\t\t\treturn results[keys[0]]\n\t\t}\n\n\t\treturn results\n\t}\n}\n\nNode.addIndex('id')\n\nmodule.exports = Node\n",
    "static": true,
    "longname": "/Volumes/DATA/Sites/projects/36_maggoo/neo-maggoo/lib/Node.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 114,
    "kind": "variable",
    "name": "neo4j",
    "memberof": "lib/Node.js",
    "static": true,
    "longname": "lib/Node.js~neo4j",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/Node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 3,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 115,
    "kind": "variable",
    "name": "Model",
    "memberof": "lib/Node.js",
    "static": true,
    "longname": "lib/Node.js~Model",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/Node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 4,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 116,
    "kind": "variable",
    "name": "NodeCollection",
    "memberof": "lib/Node.js",
    "static": true,
    "longname": "lib/Node.js~NodeCollection",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/Node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 5,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 117,
    "kind": "variable",
    "name": "RelatedNode",
    "memberof": "lib/Node.js",
    "static": true,
    "longname": "lib/Node.js~RelatedNode",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/Node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 6,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 118,
    "kind": "variable",
    "name": "RelatedNodeCollection",
    "memberof": "lib/Node.js",
    "static": true,
    "longname": "lib/Node.js~RelatedNodeCollection",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/Node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 7,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 119,
    "kind": "variable",
    "name": "Relationship",
    "memberof": "lib/Node.js",
    "static": true,
    "longname": "lib/Node.js~Relationship",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/Node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 8,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 120,
    "kind": "variable",
    "name": "Graph",
    "memberof": "lib/Node.js",
    "static": true,
    "longname": "lib/Node.js~Graph",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/Node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 9,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 121,
    "kind": "variable",
    "name": "DB",
    "memberof": "lib/Node.js",
    "static": true,
    "longname": "lib/Node.js~DB",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/Node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 10,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 122,
    "kind": "variable",
    "name": "shortid",
    "memberof": "lib/Node.js",
    "static": true,
    "longname": "lib/Node.js~shortid",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/Node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 11,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 123,
    "kind": "variable",
    "name": "merge",
    "memberof": "lib/Node.js",
    "static": true,
    "longname": "lib/Node.js~merge",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/Node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 124,
    "kind": "typedef",
    "name": "QueryOptions",
    "memberof": "lib/Node.js",
    "static": true,
    "longname": "lib/Node.js~QueryOptions",
    "access": "public",
    "description": "Query options object",
    "properties": [
      {
        "nullable": null,
        "types": [
          "Object.<String, *>"
        ],
        "spread": false,
        "optional": true,
        "name": "parameters",
        "description": "Parameters used in the query."
      },
      {
        "nullable": null,
        "types": [
          "String"
        ],
        "spread": false,
        "optional": true,
        "name": "variable",
        "description": "The variable used to identify the Node in the query, 'n' by default."
      },
      {
        "nullable": null,
        "types": [
          "Array"
        ],
        "spread": false,
        "optional": true,
        "name": "variables",
        "description": "All variables used in the query that should be added to the results."
      },
      {
        "nullable": null,
        "types": [
          "String",
          "Array"
        ],
        "spread": false,
        "optional": true,
        "name": "where",
        "description": "The where clause, arrays are joined by the 'AND' operator."
      },
      {
        "nullable": null,
        "types": [
          "Number"
        ],
        "spread": false,
        "optional": true,
        "name": "limit",
        "description": "The maximum number of results to be returned"
      },
      {
        "nullable": null,
        "types": [
          "String"
        ],
        "spread": false,
        "optional": true,
        "name": "with",
        "description": "The name of relationship to include, use the dot-notation to include multiple levels"
      },
      {
        "nullable": null,
        "types": [
          "Array"
        ],
        "spread": false,
        "optional": true,
        "name": "with",
        "description": "An array of names of relationships to include"
      },
      {
        "nullable": null,
        "types": [
          "Object.<String, Boolean|Object>"
        ],
        "spread": false,
        "optional": true,
        "name": "with",
        "description": "Relationships to include (true) or exclude (false) or filter(object)"
      },
      {
        "nullable": null,
        "types": [
          "Object.<String, NodeLink>"
        ],
        "spread": false,
        "optional": true,
        "name": "links",
        "description": "Linked results to connect to this model"
      }
    ],
    "type": {
      "types": [
        "Object"
      ],
      "optional": false,
      "name": "QueryOptions"
    }
  },
  {
    "__docId__": 125,
    "kind": "typedef",
    "name": "NodeLink",
    "memberof": "lib/Node.js",
    "static": true,
    "longname": "lib/Node.js~NodeLink",
    "access": "public",
    "description": "",
    "properties": [
      {
        "nullable": null,
        "types": [
          "String"
        ],
        "spread": false,
        "optional": true,
        "name": "start",
        "description": "Reference to the start node (defaults to 'n')"
      },
      {
        "nullable": null,
        "types": [
          "String"
        ],
        "spread": false,
        "optional": false,
        "name": "end",
        "description": "Reference to the end node"
      },
      {
        "nullable": null,
        "types": [
          "Boolean"
        ],
        "spread": false,
        "optional": true,
        "name": "singular",
        "description": "Only one result per record is returned (eg. when using scalar values or by using `collect`)"
      }
    ],
    "type": {
      "types": [
        "Object"
      ],
      "optional": false,
      "name": "NodeLink"
    }
  },
  {
    "__docId__": 126,
    "kind": "typedef",
    "name": "RelationshipDefinition",
    "memberof": "lib/Node.js",
    "static": true,
    "longname": "lib/Node.js~RelationshipDefinition",
    "access": "public",
    "description": "Relationship definition object",
    "lineNumber": 45,
    "properties": [
      {
        "nullable": null,
        "types": [
          "Node",
          "function"
        ],
        "spread": false,
        "optional": false,
        "name": "Model",
        "description": "{@link Relationship.Model}"
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "type",
        "description": "{@link Relationship.type}"
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "direction",
        "description": "{@link Relationship.direction}"
      },
      {
        "nullable": null,
        "types": [
          "boolean"
        ],
        "spread": false,
        "optional": false,
        "name": "singular",
        "description": "{@link Relationship.singular}"
      }
    ],
    "type": {
      "types": [
        "object"
      ],
      "optional": false,
      "name": "RelationshipDefinition"
    }
  },
  {
    "__docId__": 127,
    "kind": "variable",
    "name": "REGEX_INDEX",
    "memberof": "lib/Node.js",
    "static": true,
    "longname": "lib/Node.js~REGEX_INDEX",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/Node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 46,
    "undocument": true,
    "type": {
      "types": [
        "undefined"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 128,
    "kind": "variable",
    "name": "_related",
    "memberof": "lib/Node.js",
    "static": true,
    "longname": "lib/Node.js~_related",
    "access": "private",
    "export": false,
    "importPath": "neo-maggoo/lib/Node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 49,
    "undocument": true,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 129,
    "kind": "variable",
    "name": "_linked",
    "memberof": "lib/Node.js",
    "static": true,
    "longname": "lib/Node.js~_linked",
    "access": "private",
    "export": false,
    "importPath": "neo-maggoo/lib/Node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 50,
    "undocument": true,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 130,
    "kind": "variable",
    "name": "_labels",
    "memberof": "lib/Node.js",
    "static": true,
    "longname": "lib/Node.js~_labels",
    "access": "private",
    "export": false,
    "importPath": "neo-maggoo/lib/Node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 51,
    "undocument": true,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 131,
    "kind": "class",
    "name": "Node",
    "memberof": "lib/Node.js",
    "static": true,
    "longname": "lib/Node.js~Node",
    "access": "public",
    "export": true,
    "importPath": "neo-maggoo/lib/Node.js",
    "importStyle": "Node",
    "description": "Class representing a single node",
    "lineNumber": 56,
    "interface": false,
    "extends": [
      "Model"
    ]
  },
  {
    "__docId__": 132,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#constructor",
    "access": "public",
    "description": "Creates an instance of Node.",
    "lineNumber": 64,
    "params": [
      {
        "nullable": null,
        "types": [
          "Node",
          "neo4j.types.Node"
        ],
        "spread": false,
        "optional": false,
        "name": "node",
        "description": "Node data object or neo4j Node"
      },
      {
        "nullable": null,
        "types": [
          "Graph"
        ],
        "spread": false,
        "optional": true,
        "name": "graph",
        "description": "The current graph"
      }
    ]
  },
  {
    "__docId__": 134,
    "kind": "member",
    "name": "$entity",
    "memberof": "lib/Node.js~Node",
    "static": false,
    "longname": "lib/Node.js~Node#$entity",
    "access": "public",
    "description": "",
    "lineNumber": 75,
    "type": {
      "nullable": null,
      "types": [
        "neo4.Node"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 135,
    "kind": "member",
    "name": "[_related]",
    "memberof": "lib/Node.js~Node",
    "static": false,
    "longname": "lib/Node.js~Node#[_related]",
    "access": "private",
    "description": "",
    "lineNumber": 85,
    "ignore": true,
    "type": {
      "types": [
        "{}"
      ]
    }
  },
  {
    "__docId__": 136,
    "kind": "member",
    "name": "[_linked]",
    "memberof": "lib/Node.js~Node",
    "static": false,
    "longname": "lib/Node.js~Node#[_linked]",
    "access": "private",
    "description": "",
    "lineNumber": 90,
    "ignore": true,
    "type": {
      "types": [
        "{}"
      ]
    }
  },
  {
    "__docId__": 137,
    "kind": "member",
    "name": "$graph",
    "memberof": "lib/Node.js~Node",
    "static": false,
    "longname": "lib/Node.js~Node#$graph",
    "access": "public",
    "description": "",
    "lineNumber": 95,
    "type": {
      "nullable": null,
      "types": [
        "Graph"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 138,
    "kind": "method",
    "name": "uuid",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Node.js~Node.uuid",
    "access": "public",
    "description": "ID generator, uses ShortId by default",
    "lineNumber": 102,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} ID"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "ID"
    },
    "params": []
  },
  {
    "__docId__": 139,
    "kind": "method",
    "name": "addIndex",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Node.js~Node.addIndex",
    "access": "public",
    "description": null,
    "lineNumber": 107,
    "undocument": true,
    "params": [
      {
        "name": "property",
        "types": [
          "*"
        ]
      },
      {
        "name": "now",
        "optional": true,
        "types": [
          "boolean"
        ],
        "defaultRaw": false,
        "defaultValue": "false"
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 140,
    "kind": "method",
    "name": "addUnique",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Node.js~Node.addUnique",
    "access": "public",
    "description": null,
    "lineNumber": 112,
    "undocument": true,
    "params": [
      {
        "name": "property",
        "types": [
          "*"
        ]
      },
      {
        "name": "now",
        "optional": true,
        "types": [
          "boolean"
        ],
        "defaultRaw": false,
        "defaultValue": "false"
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 141,
    "kind": "method",
    "name": "dropIndex",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": true,
    "static": true,
    "longname": "lib/Node.js~Node.dropIndex",
    "access": "public",
    "description": null,
    "lineNumber": 117,
    "undocument": true,
    "params": [
      {
        "name": "property",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 142,
    "kind": "method",
    "name": "dropUnique",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": true,
    "static": true,
    "longname": "lib/Node.js~Node.dropUnique",
    "access": "public",
    "description": null,
    "lineNumber": 122,
    "undocument": true,
    "params": [
      {
        "name": "property",
        "types": [
          "*"
        ]
      }
    ],
    "return": null
  },
  {
    "__docId__": 143,
    "kind": "get",
    "name": "Collection",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Node.js~Node.Collection",
    "access": "public",
    "description": null,
    "lineNumber": 127,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 144,
    "kind": "get",
    "name": "id",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#id",
    "access": "public",
    "description": "The node ID.\nThis will be automatically generated when the node is saved",
    "lineNumber": 146,
    "type": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 145,
    "kind": "set",
    "name": "id",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#id",
    "access": "public",
    "description": null,
    "lineNumber": 151,
    "undocument": true
  },
  {
    "__docId__": 146,
    "kind": "get",
    "name": "$id",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#$id",
    "access": "public",
    "description": "The neo4j entity ID.\nNote that this could change over time, use id instead.",
    "lineNumber": 163,
    "unknown": [
      {
        "tagName": "@readonly",
        "tagValue": ""
      }
    ],
    "type": {
      "nullable": null,
      "types": [
        "number"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 147,
    "kind": "get",
    "name": "$new",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#$new",
    "access": "public",
    "description": "Whether or not the node is already stored in the graph database.",
    "lineNumber": 173,
    "type": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 148,
    "kind": "get",
    "name": "$dirty",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#$dirty",
    "access": "public",
    "description": "Whether or not the Node has changed properties.",
    "lineNumber": 183,
    "type": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 149,
    "kind": "method",
    "name": "setProperty",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#setProperty",
    "access": "public",
    "description": "Set property value",
    "lineNumber": 194,
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "key",
        "description": "Property name"
      },
      {
        "nullable": null,
        "types": [
          "any"
        ],
        "spread": false,
        "optional": false,
        "name": "value",
        "description": "Property value"
      }
    ],
    "return": null
  },
  {
    "__docId__": 150,
    "kind": "method",
    "name": "get",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#get",
    "access": "public",
    "description": "Get a Node property or related node(s).",
    "lineNumber": 210,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{any|RelatedNodeCollection} The value or related node(s)"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "key",
        "description": "The name of the property or relationship"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "any",
        "RelatedNodeCollection"
      ],
      "spread": false,
      "description": "The value or related node(s)"
    }
  },
  {
    "__docId__": 151,
    "kind": "method",
    "name": "set",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#set",
    "access": "public",
    "description": "Set a Node property or related node(s).",
    "lineNumber": 234,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{boolean} Whether or not the property was successfully set"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "key",
        "description": "The name of the property or relationship"
      },
      {
        "nullable": null,
        "types": [
          "any"
        ],
        "spread": false,
        "optional": false,
        "name": "value",
        "description": "The value or related node(s)"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": "Whether or not the property was successfully set"
    }
  },
  {
    "__docId__": 152,
    "kind": "method",
    "name": "has",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#has",
    "access": "public",
    "description": null,
    "lineNumber": 244,
    "undocument": true,
    "params": [
      {
        "name": "key",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 153,
    "kind": "get",
    "name": "relationships",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Node.js~Node.relationships",
    "access": "public",
    "description": "Definitions of the relationships for this Node",
    "lineNumber": 258,
    "unknown": [
      {
        "tagName": "@readonly",
        "tagValue": ""
      }
    ],
    "type": {
      "nullable": null,
      "types": [
        "object.<string, RelationshipDefinition>"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 154,
    "kind": "method",
    "name": "getRelationship",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Node.js~Node.getRelationship",
    "access": "public",
    "description": "Get a Relationship class by name.",
    "lineNumber": 269,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Relationship} The Relationship class"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "name",
        "description": "The name of the relationship"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Relationship"
      ],
      "spread": false,
      "description": "The Relationship class"
    }
  },
  {
    "__docId__": 155,
    "kind": "method",
    "name": "getRelationship",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#getRelationship",
    "access": "public",
    "description": "Get a Relationship class by name.",
    "lineNumber": 291,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Relationship} The Relationship class"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "name",
        "description": "The name of the relationship"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Relationship"
      ],
      "spread": false,
      "description": "The Relationship class"
    }
  },
  {
    "__docId__": 156,
    "kind": "method",
    "name": "getRelated",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#getRelated",
    "access": "public",
    "description": "Get related node(s).",
    "lineNumber": 302,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{RelatedNodeCollection} The related node(s)"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "name",
        "description": "The name of the relationship"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "RelatedNodeCollection"
      ],
      "spread": false,
      "description": "The related node(s)"
    }
  },
  {
    "__docId__": 157,
    "kind": "method",
    "name": "getLinked",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#getLinked",
    "access": "public",
    "description": "Get linked results.",
    "lineNumber": 330,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{*} The related node(s) / value(s) or null if none is found"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "name",
        "description": "The name of the link"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "*"
      ],
      "spread": false,
      "description": "The related node(s) / value(s) or null if none is found"
    }
  },
  {
    "__docId__": 158,
    "kind": "method",
    "name": "addRelated",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#addRelated",
    "access": "public",
    "description": "Add related node(s).\nExisting nodes will not be overwritten unless the relationship is singular.",
    "lineNumber": 360,
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "name",
        "description": "The name of the relationship"
      },
      {
        "nullable": null,
        "types": [
          "Node",
          "NodeCollection",
          "Node[]"
        ],
        "spread": false,
        "optional": false,
        "name": "node",
        "description": "Node(s)"
      },
      {
        "nullable": null,
        "types": [
          "Object"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "{}",
        "defaultRaw": {},
        "name": "properties",
        "description": "Properties to set on the relationship(s)"
      }
    ],
    "return": null
  },
  {
    "__docId__": 159,
    "kind": "method",
    "name": "setRelated",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#setRelated",
    "access": "public",
    "description": "Set related node(s).",
    "lineNumber": 373,
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "name",
        "description": "The name of the relationship"
      },
      {
        "nullable": null,
        "types": [
          "Node",
          "NodeCollection",
          "Node[]"
        ],
        "spread": false,
        "optional": false,
        "name": "node",
        "description": "Node(s)"
      },
      {
        "nullable": null,
        "types": [
          "any"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "{}",
        "defaultRaw": {},
        "name": "properties",
        "description": "Properties to set on the relationship(s)"
      },
      {
        "nullable": null,
        "types": [
          "boolean"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "true",
        "defaultRaw": true,
        "name": "overwrite",
        "description": "If set to false existing nodes will not be overwritten unless the relationship is singular"
      }
    ],
    "return": null
  },
  {
    "__docId__": 160,
    "kind": "method",
    "name": "clearCachedRelationships",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#clearCachedRelationships",
    "access": "public",
    "description": null,
    "lineNumber": 412,
    "undocument": true,
    "params": [
      {
        "name": "relationships",
        "optional": true,
        "types": [
          "undefined"
        ],
        "defaultValue": "undefined"
      }
    ],
    "return": null
  },
  {
    "__docId__": 161,
    "kind": "get",
    "name": "labels",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Node.js~Node.labels",
    "access": "public",
    "description": null,
    "lineNumber": 434,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 162,
    "kind": "get",
    "name": "baseLabel",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Node.js~Node.baseLabel",
    "access": "public",
    "description": null,
    "lineNumber": 456,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 163,
    "kind": "get",
    "name": "$base",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#$base",
    "access": "public",
    "description": null,
    "lineNumber": 461,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 164,
    "kind": "get",
    "name": "$labels",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#$labels",
    "access": "public",
    "description": "Node labels. Will be added the node in the graph database.\nBy default it uses the constructor name.",
    "lineNumber": 472,
    "type": {
      "nullable": null,
      "types": [
        "Array"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 165,
    "kind": "member",
    "name": "[_labels]",
    "memberof": "lib/Node.js~Node",
    "static": false,
    "longname": "lib/Node.js~Node#[_labels]",
    "access": "private",
    "description": null,
    "lineNumber": 483,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 166,
    "kind": "set",
    "name": "$labels",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Node.js~Node#$labels",
    "access": "public",
    "description": "Node labels. Will be added the node in the graph database.\nBy default it uses the constructor name.",
    "lineNumber": 495,
    "params": [
      {
        "nullable": null,
        "types": [
          "Array"
        ],
        "spread": false,
        "optional": false,
        "name": "labels",
        "description": "Labels"
      }
    ],
    "type": {
      "nullable": null,
      "types": [
        "Array"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 168,
    "kind": "method",
    "name": "save",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "lib/Node.js~Node#save",
    "access": "public",
    "description": "Save the Node to the graph database.",
    "lineNumber": 513,
    "params": [
      {
        "nullable": null,
        "types": [
          "boolean",
          "string[]"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "false",
        "defaultRaw": false,
        "name": "deep",
        "description": "If true save all related nodes, or specific relationships defined as an array of strings."
      },
      {
        "nullable": null,
        "types": [
          "any"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "null",
        "defaultRaw": null,
        "name": "tx",
        "description": "The current database transaction"
      }
    ],
    "return": null
  },
  {
    "__docId__": 171,
    "kind": "method",
    "name": "saveRelated",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "lib/Node.js~Node#saveRelated",
    "access": "public",
    "description": "Save related nodes and their relationships",
    "lineNumber": 580,
    "params": [
      {
        "nullable": null,
        "types": [
          "Array"
        ],
        "spread": false,
        "optional": true,
        "name": "keys",
        "description": "The relationships to be saved (all by default)"
      },
      {
        "nullable": null,
        "types": [
          "Transaction"
        ],
        "spread": false,
        "optional": true,
        "name": "tx",
        "description": "The current database transaction"
      }
    ],
    "return": null
  },
  {
    "__docId__": 172,
    "kind": "method",
    "name": "delete",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "lib/Node.js~Node#delete",
    "access": "public",
    "description": "Delete node from the graph database",
    "lineNumber": 623,
    "params": [
      {
        "nullable": null,
        "types": [
          "boolean"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "false",
        "defaultRaw": false,
        "name": "deep",
        "description": "Delete related nodes"
      },
      {
        "nullable": null,
        "types": [
          "Transaction"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "null",
        "defaultRaw": null,
        "name": "tx",
        "description": "The current database transaction"
      }
    ],
    "return": null
  },
  {
    "__docId__": 174,
    "kind": "method",
    "name": "deleteRelated",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "lib/Node.js~Node#deleteRelated",
    "access": "public",
    "description": "Delete related nodes and their relationships",
    "lineNumber": 683,
    "params": [
      {
        "nullable": null,
        "types": [
          "Transaction"
        ],
        "spread": false,
        "optional": true,
        "name": "tx",
        "description": "The current database transaction"
      }
    ],
    "return": null
  },
  {
    "__docId__": 175,
    "kind": "method",
    "name": "addLabel",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "lib/Node.js~Node#addLabel",
    "access": "public",
    "description": null,
    "lineNumber": 702,
    "undocument": true,
    "params": [
      {
        "name": "label",
        "types": [
          "*"
        ]
      },
      {
        "name": "tx",
        "optional": true,
        "types": [
          "undefined"
        ],
        "defaultValue": "undefined"
      }
    ],
    "return": null
  },
  {
    "__docId__": 176,
    "kind": "method",
    "name": "addLabels",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "lib/Node.js~Node#addLabels",
    "access": "public",
    "description": null,
    "lineNumber": 707,
    "undocument": true,
    "params": [
      {
        "name": "labels",
        "types": [
          "*"
        ]
      },
      {
        "name": "tx",
        "optional": true,
        "types": [
          "undefined"
        ],
        "defaultValue": "undefined"
      }
    ],
    "return": null
  },
  {
    "__docId__": 177,
    "kind": "method",
    "name": "removeLabel",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "lib/Node.js~Node#removeLabel",
    "access": "public",
    "description": null,
    "lineNumber": 750,
    "undocument": true,
    "params": [
      {
        "name": "label",
        "types": [
          "*"
        ]
      },
      {
        "name": "tx",
        "optional": true,
        "types": [
          "undefined"
        ],
        "defaultValue": "undefined"
      }
    ],
    "return": null
  },
  {
    "__docId__": 178,
    "kind": "method",
    "name": "removeLabels",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "lib/Node.js~Node#removeLabels",
    "access": "public",
    "description": null,
    "lineNumber": 755,
    "undocument": true,
    "params": [
      {
        "name": "labels",
        "types": [
          "*"
        ]
      },
      {
        "name": "tx",
        "optional": true,
        "types": [
          "undefined"
        ],
        "defaultValue": "undefined"
      }
    ],
    "return": null
  },
  {
    "__docId__": 180,
    "kind": "get",
    "name": "queryDefaults",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Node.js~Node.queryDefaults",
    "access": "public",
    "description": "Default values for query options",
    "lineNumber": 805,
    "type": {
      "types": [
        "{\"parameters\": *, \"variable\": string, \"variables\": *, \"links\": *}"
      ]
    }
  },
  {
    "__docId__": 181,
    "kind": "method",
    "name": "get",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": true,
    "static": true,
    "longname": "lib/Node.js~Node.get",
    "access": "public",
    "description": "Fetch a single Node",
    "examples": [
      "const node = await Node.get('foo')",
      "const node = await Node.get({ id: 'foo' })"
    ],
    "lineNumber": 828,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Node} Result"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string",
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "filters",
        "description": "Filter object or Node id"
      },
      {
        "nullable": null,
        "types": [
          "QueryOptions"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "{}",
        "defaultRaw": {},
        "name": "o",
        "description": "Query options"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Node"
      ],
      "spread": false,
      "description": "Result"
    }
  },
  {
    "__docId__": 182,
    "kind": "method",
    "name": "all",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": true,
    "static": true,
    "longname": "lib/Node.js~Node.all",
    "access": "public",
    "description": "Fetch Nodes",
    "examples": [
      "const nodes = await Node.all({ limit: 10 })"
    ],
    "lineNumber": 844,
    "params": [
      {
        "nullable": null,
        "types": [
          "QueryOptions"
        ],
        "spread": false,
        "optional": false,
        "name": "o",
        "description": "Query options"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "NodeCollection"
      ],
      "spread": false,
      "description": "Results"
    }
  },
  {
    "__docId__": 183,
    "kind": "method",
    "name": "query",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": true,
    "static": true,
    "longname": "lib/Node.js~Node.query",
    "access": "public",
    "description": "Use a query statement to search for Nodes\nBy default returns results for 'n' as Node collection",
    "examples": [
      "const nodes = await Node.query(`\n    MATCH (n:Node)\n    WHERE n.foo > {foo}\n`, { foo: 1 })"
    ],
    "lineNumber": 864,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{NodeCollection} Results"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "query",
        "description": "A search query"
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "{}",
        "defaultRaw": {},
        "name": "parameters",
        "description": "Parameters used in query"
      },
      {
        "nullable": null,
        "types": [
          "QueryOptions"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "{}",
        "defaultRaw": {},
        "name": "o",
        "description": "Query options"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "NodeCollection"
      ],
      "spread": false,
      "description": "Results"
    }
  },
  {
    "__docId__": 184,
    "kind": "method",
    "name": "where",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": true,
    "static": true,
    "longname": "lib/Node.js~Node.where",
    "access": "public",
    "description": "Use a query statement to search for Nodes\nBy default returns results for 'n' as Node collection",
    "examples": [
      "const nodes = await Node.where('n.foo > {foo}', { foo: 1 })"
    ],
    "lineNumber": 883,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{NodeCollection} Results"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "where",
        "description": "A where clause"
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "{}",
        "defaultRaw": {},
        "name": "parameters",
        "description": "Parameters used in query"
      },
      {
        "nullable": null,
        "types": [
          "QueryOptions"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "{}",
        "defaultRaw": {},
        "name": "o",
        "description": "Query options"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "NodeCollection"
      ],
      "spread": false,
      "description": "Results"
    }
  },
  {
    "__docId__": 185,
    "kind": "method",
    "name": "find",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": true,
    "static": true,
    "longname": "lib/Node.js~Node.find",
    "access": "public",
    "description": "Find Nodes based on filter or Node ID",
    "examples": [
      "// Find by ID\nconst nodes = Node.find('foo')",
      "// Find by filter\nconst nodes = Node.find({ foo: 1 })",
      "// Find by filter, with related Nodes\nconst nodes = Node.find({ foo: 1 }, { with: 'relatives' })\nnodes[0].relatives"
    ],
    "lineNumber": 910,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{NodeCollection} Results"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object",
          "string",
          "number"
        ],
        "spread": false,
        "optional": false,
        "name": "filters",
        "description": "Search filters, Node ID (string), or neo4j node identifier (number)"
      },
      {
        "nullable": null,
        "types": [
          "QueryOptions"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "{}",
        "defaultRaw": {},
        "name": "o",
        "description": "Query options"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "NodeCollection"
      ],
      "spread": false,
      "description": "Results"
    }
  },
  {
    "__docId__": 186,
    "kind": "method",
    "name": "buildQuery",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Node.js~Node.buildQuery",
    "access": "public",
    "description": "Build a search query",
    "lineNumber": 978,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} Query string"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "o",
        "description": "Query options"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "Query string"
    }
  },
  {
    "__docId__": 187,
    "kind": "method",
    "name": "parseQueryFilters",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Node.js~Node.parseQueryFilters",
    "access": "public",
    "description": "Parse search filters",
    "lineNumber": 1076,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{QueryOptions} Filters options object"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object",
          "string",
          "number"
        ],
        "spread": false,
        "optional": false,
        "name": "filters",
        "description": "Search filters, Node ID (string), or neo4j node identifier (number)"
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "variable",
        "description": "Variable for the current node"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "QueryOptions"
      ],
      "spread": false,
      "description": "Filters options object"
    }
  },
  {
    "__docId__": 188,
    "kind": "method",
    "name": "count",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": true,
    "static": true,
    "longname": "lib/Node.js~Node.count",
    "access": "public",
    "description": "Count nodes in graph database",
    "lineNumber": 1152,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{number} Number of nodes"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object",
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "filters",
        "description": "Search filters (object) or where clause (string)"
      },
      {
        "nullable": null,
        "types": [
          "any"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "{}",
        "defaultRaw": {},
        "name": "parameters",
        "description": "Parameters used in where clause"
      },
      {
        "nullable": null,
        "types": [
          "QueryOptions"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "{}",
        "defaultRaw": {},
        "name": "o",
        "description": "Query options"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "number"
      ],
      "spread": false,
      "description": "Number of nodes"
    }
  },
  {
    "__docId__": 189,
    "kind": "method",
    "name": "getRelationshipQueryOptions",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Node.js~Node.getRelationshipQueryOptions",
    "access": "public",
    "description": "Build query options for related nodes\nMostly intended for internal usage.",
    "lineNumber": 1186,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{options} Query options object"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "levels",
        "description": "Filter for related nodes in dot-format (eg. father.children will fetch the related 'father' and its 'children')"
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "variables",
        "description": "The variables currently used for building the query"
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "'n'",
        "defaultRaw": "'n'",
        "name": "reference",
        "description": "Reference variable for the current node"
      }
    ],
    "properties": [
      {
        "nullable": null,
        "types": [
          "array"
        ],
        "spread": false,
        "optional": false,
        "name": "matches",
        "description": "Optional matches for each relationship"
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "variables",
        "description": "The variables currently used for building the query"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "options"
      ],
      "spread": false,
      "description": "Query options object"
    }
  },
  {
    "__docId__": 190,
    "kind": "method",
    "name": "normalizeRelationshipLevels",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Node.js~Node.normalizeRelationshipLevels",
    "access": "public",
    "description": null,
    "lineNumber": 1266,
    "undocument": true,
    "params": [
      {
        "name": "levels",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 191,
    "kind": "method",
    "name": "merge",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": true,
    "static": true,
    "longname": "lib/Node.js~Node.merge",
    "access": "public",
    "description": "Get a node or a create a new one based on the given properties",
    "lineNumber": 1299,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Node} Resulting Node"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "criteria",
        "description": "Specific properties to match"
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "properties",
        "description": "Properties to be set on the existing or created node"
      },
      {
        "nullable": null,
        "types": [
          "QueryOptions"
        ],
        "spread": false,
        "optional": true,
        "defaultValue": "{}",
        "defaultRaw": {},
        "name": "o",
        "description": "Query options"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Node"
      ],
      "spread": false,
      "description": "Resulting Node"
    }
  },
  {
    "__docId__": 192,
    "kind": "method",
    "name": "fetchRelated",
    "memberof": "lib/Node.js~Node",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "lib/Node.js~Node#fetchRelated",
    "access": "public",
    "description": "Fetch related Nodes connected to the current node.",
    "lineNumber": 1359,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{NodeCollection|Object.<string, NodeCollection>} The related nodes"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object",
          "array",
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "relationships",
        "description": "Similar to 'with' option in #Node.find"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "NodeCollection",
        "Object.<string, NodeCollection>"
      ],
      "spread": false,
      "description": "The related nodes"
    }
  },
  {
    "__docId__": 193,
    "kind": "file",
    "name": "lib/NodeCollection.js",
    "content": "'use strict'\n\nconst { Collection } = require('maggoo')\nconst DB = require('./DB')\nconst neo4j = require('neo4j-driver/lib/v1')\n\n/**\n * A Node collection that allows saving & deleting an array of nodes\n */\nclass NodeCollection extends Collection\n{\n\tconstructor(Node, items)\n\t{\n\t\tif (items && !Array.isArray(items))\n\t\t{\n\t\t\titems = [items]\n\t\t}\n\n\t\titems = items && items.map((item) =>\n\t\t{\n\t\t\tif (item instanceof neo4j.types.Node)\n\t\t\t{\n\t\t\t\treturn new Node(item)\n\t\t\t}\n\n\t\t\treturn item\n\t\t})\n\n\t\tsuper(Node, items)\n\t}\n\n\t/**\n\t * Save all Nodes in this collection\n\t *\n\t * @param {boolean|Array} [deep] If true save all related node, or an array of specific relationships\n\t */\n\tasync save(deep = false)\n\t{\n\t\tconst tx = DB.beginTransaction()\n\t\tconst session = tx.session\n\n\t\tconst run = this.wrap('save')\n\n\t\tawait run(deep, tx)\n\n\t\tawait tx.commit().then(r => r)\n\n\t\tsession.close()\n\t}\n\n\t/**\n\t * Deletes all Nodes in this collection\n\t *\n\t * @param {boolean|Array} [deep] If true delete all related nodes, or an array of specific relationships\n\t */\n\tasync delete(deep)\n\t{\n\t\tconst tx = DB.beginTransaction()\n\t\tconst session = tx.session\n\n\t\tconst run = this.wrap('delete')\n\n\t\tawait run(deep, tx)\n\n\t\tawait tx.commit().then(r => r)\n\n\t\tsession.close()\n\t}\n}\n\nmodule.exports = NodeCollection\n",
    "static": true,
    "longname": "/Volumes/DATA/Sites/projects/36_maggoo/neo-maggoo/lib/NodeCollection.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 194,
    "kind": "variable",
    "name": "Collection",
    "memberof": "lib/NodeCollection.js",
    "static": true,
    "longname": "lib/NodeCollection.js~Collection",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/NodeCollection.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 3,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 195,
    "kind": "variable",
    "name": "DB",
    "memberof": "lib/NodeCollection.js",
    "static": true,
    "longname": "lib/NodeCollection.js~DB",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/NodeCollection.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 4,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 196,
    "kind": "variable",
    "name": "neo4j",
    "memberof": "lib/NodeCollection.js",
    "static": true,
    "longname": "lib/NodeCollection.js~neo4j",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/NodeCollection.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 5,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 197,
    "kind": "class",
    "name": "NodeCollection",
    "memberof": "lib/NodeCollection.js",
    "static": true,
    "longname": "lib/NodeCollection.js~NodeCollection",
    "access": "public",
    "export": true,
    "importPath": "neo-maggoo/lib/NodeCollection.js",
    "importStyle": "NodeCollection",
    "description": "A Node collection that allows saving & deleting an array of nodes",
    "lineNumber": 10,
    "interface": false,
    "extends": [
      "Collection"
    ]
  },
  {
    "__docId__": 198,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "lib/NodeCollection.js~NodeCollection",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/NodeCollection.js~NodeCollection#constructor",
    "access": "public",
    "description": null,
    "lineNumber": 12,
    "undocument": true
  },
  {
    "__docId__": 199,
    "kind": "method",
    "name": "save",
    "memberof": "lib/NodeCollection.js~NodeCollection",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "lib/NodeCollection.js~NodeCollection#save",
    "access": "public",
    "description": "Save all Nodes in this collection",
    "lineNumber": 37,
    "params": [
      {
        "nullable": null,
        "types": [
          "boolean",
          "Array"
        ],
        "spread": false,
        "optional": true,
        "name": "deep",
        "description": "If true save all related node, or an array of specific relationships"
      }
    ],
    "return": null
  },
  {
    "__docId__": 200,
    "kind": "method",
    "name": "delete",
    "memberof": "lib/NodeCollection.js~NodeCollection",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "lib/NodeCollection.js~NodeCollection#delete",
    "access": "public",
    "description": "Deletes all Nodes in this collection",
    "lineNumber": 56,
    "params": [
      {
        "nullable": null,
        "types": [
          "boolean",
          "Array"
        ],
        "spread": false,
        "optional": true,
        "name": "deep",
        "description": "If true delete all related nodes, or an array of specific relationships"
      }
    ],
    "return": null
  },
  {
    "__docId__": 201,
    "kind": "file",
    "name": "lib/RelatedNode.js",
    "content": "'use strict'\n\nclass RelatedNode {}\n\n/**\n * Adds relationship data to a special $rel property of the end Node\n */\nconst proxy = new Proxy(RelatedNode, {\n\tconstruct(obj, [$Relationship, start, end, properties = {}, graph = null])\n\t{\n\t\tlet rel = null\n\n\t\tif (graph)\n\t\t{\n\t\t\trel = graph.getRelationship(start, end, $Relationship)\n\t\t}\n\n\t\tif (!rel)\n\t\t{\n\t\t\trel = new $Relationship(properties, graph)\n\t\t}\n\n\t\trel.start = start\n\t\trel.end = end\n\n\t\treturn new Proxy(end, {\n\t\t\tgetPrototypeOf: () =>\n\t\t\t{\n\t\t\t\treturn $Relationship.Model.prototype\n\t\t\t},\n\t\t\thas(target, name)\n\t\t\t{\n\t\t\t\tif (name === '$rel')\n\t\t\t\t{\n\t\t\t\t\treturn true\n\t\t\t\t}\n\n\t\t\t\treturn Reflect.has(...arguments)\n\t\t\t},\n\t\t\tget(target, name)\n\t\t\t{\n\t\t\t\tif (name === '$rel')\n\t\t\t\t{\n\t\t\t\t\treturn rel\n\t\t\t\t}\n\n\t\t\t\treturn target[name]\n\t\t\t}\n\t\t})\n\t}\n})\n\nmodule.exports = proxy\n",
    "static": true,
    "longname": "/Volumes/DATA/Sites/projects/36_maggoo/neo-maggoo/lib/RelatedNode.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 202,
    "kind": "class",
    "name": "RelatedNode",
    "memberof": "lib/RelatedNode.js",
    "static": true,
    "longname": "lib/RelatedNode.js~RelatedNode",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/RelatedNode.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 3,
    "undocument": true,
    "interface": false,
    "ignore": true
  },
  {
    "__docId__": 203,
    "kind": "file",
    "name": "lib/RelatedNodeCollection.js",
    "content": "'use strict'\n\nconst NodeCollection = require('./NodeCollection')\nconst RelatedNode = require('./RelatedNode')\n\n/**\n * A Node Collection related to a specified start Node\n */\nclass RelatedNodeCollection extends NodeCollection\n{\n\t/**\n\t * Creates an instance of RelatedNodeCollection.\n\t *\n\t * @param {Relationship} Relationship The Relationship class\n\t * @param {Array} items The related Nodes\n\t * @param {Node} start The start Node\n\t */\n\tconstructor(Relationship, items, start)\n\t{\n\t\tsuper(Relationship.Model, items)\n\n\t\tthis.$Relationship = Relationship\n\t\tthis.$start = start\n\t}\n\n\t/**\n\t * Creates a new RelatedNode instance\n\t *\n\t * @param {Node} node The end Node\n\t * @returns {RelatedNode} RelatedNode instance\n\t */\n\tcreateRelatedNode(node)\n\t{\n\t\treturn new RelatedNode(this.$Relationship, this.$start, node, {}, this.$start.$graph)\n\t}\n}\n\n/**\n * Make sure all related Nodes will be wrapped in the RelatedNode class\n */\nconst proxify = {\n\n\tconstruct()\n\t{\n\t\tconst instance = Reflect.construct(...arguments)\n\n\t\tconst proxied = new Proxy(instance, {\n\n\t\t\tget(target, key)\n\t\t\t{\n\t\t\t\tlet value = Reflect.get(...arguments)\n\n\t\t\t\t// Wrap all nodes in a Related object\n\t\t\t\tif (value instanceof target.$Model && !('$rel' in value))\n\t\t\t\t{\n\t\t\t\t\tvalue = target[key] = target.createRelatedNode(value)\n\t\t\t\t}\n\n\t\t\t\treturn value\n\t\t\t}\n\n\t\t})\n\n\t\treturn proxied\n\t}\n\n}\n\n/**\n * All RelatedNodeCollection instances should be proxified\n */\nmodule.exports = new Proxy(RelatedNodeCollection, proxify)\n",
    "static": true,
    "longname": "/Volumes/DATA/Sites/projects/36_maggoo/neo-maggoo/lib/RelatedNodeCollection.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 204,
    "kind": "variable",
    "name": "NodeCollection",
    "memberof": "lib/RelatedNodeCollection.js",
    "static": true,
    "longname": "lib/RelatedNodeCollection.js~NodeCollection",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/RelatedNodeCollection.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 3,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 205,
    "kind": "variable",
    "name": "RelatedNode",
    "memberof": "lib/RelatedNodeCollection.js",
    "static": true,
    "longname": "lib/RelatedNodeCollection.js~RelatedNode",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/RelatedNodeCollection.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 4,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 206,
    "kind": "class",
    "name": "RelatedNodeCollection",
    "memberof": "lib/RelatedNodeCollection.js",
    "static": true,
    "longname": "lib/RelatedNodeCollection.js~RelatedNodeCollection",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/RelatedNodeCollection.js",
    "importStyle": null,
    "description": "A Node Collection related to a specified start Node",
    "lineNumber": 9,
    "interface": false,
    "extends": [
      "NodeCollection"
    ],
    "ignore": true
  },
  {
    "__docId__": 207,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "lib/RelatedNodeCollection.js~RelatedNodeCollection",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/RelatedNodeCollection.js~RelatedNodeCollection#constructor",
    "access": "public",
    "description": "Creates an instance of RelatedNodeCollection.",
    "lineNumber": 18,
    "params": [
      {
        "nullable": null,
        "types": [
          "Relationship"
        ],
        "spread": false,
        "optional": false,
        "name": "Relationship",
        "description": "The Relationship class"
      },
      {
        "nullable": null,
        "types": [
          "Array"
        ],
        "spread": false,
        "optional": false,
        "name": "items",
        "description": "The related Nodes"
      },
      {
        "nullable": null,
        "types": [
          "Node"
        ],
        "spread": false,
        "optional": false,
        "name": "start",
        "description": "The start Node"
      }
    ]
  },
  {
    "__docId__": 208,
    "kind": "member",
    "name": "$Relationship",
    "memberof": "lib/RelatedNodeCollection.js~RelatedNodeCollection",
    "static": false,
    "longname": "lib/RelatedNodeCollection.js~RelatedNodeCollection#$Relationship",
    "access": "public",
    "description": null,
    "lineNumber": 22,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 209,
    "kind": "member",
    "name": "$start",
    "memberof": "lib/RelatedNodeCollection.js~RelatedNodeCollection",
    "static": false,
    "longname": "lib/RelatedNodeCollection.js~RelatedNodeCollection#$start",
    "access": "public",
    "description": null,
    "lineNumber": 23,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 210,
    "kind": "method",
    "name": "createRelatedNode",
    "memberof": "lib/RelatedNodeCollection.js~RelatedNodeCollection",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/RelatedNodeCollection.js~RelatedNodeCollection#createRelatedNode",
    "access": "public",
    "description": "Creates a new RelatedNode instance",
    "lineNumber": 32,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{RelatedNode} RelatedNode instance"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Node"
        ],
        "spread": false,
        "optional": false,
        "name": "node",
        "description": "The end Node"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "RelatedNode"
      ],
      "spread": false,
      "description": "RelatedNode instance"
    }
  },
  {
    "__docId__": 211,
    "kind": "variable",
    "name": "proxify",
    "memberof": "lib/RelatedNodeCollection.js",
    "static": true,
    "longname": "lib/RelatedNodeCollection.js~proxify",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/RelatedNodeCollection.js",
    "importStyle": null,
    "description": "Make sure all related Nodes will be wrapped in the RelatedNode class",
    "lineNumber": 41,
    "type": {
      "types": [
        "{\"construct\": function}"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 212,
    "kind": "file",
    "name": "lib/Relationship.js",
    "content": "'use strict'\n\nconst neo4j = require('neo4j-driver/lib/v1')\nconst DB = require('./DB')\nconst { Model } = require('maggoo')\n\nconst _model = Symbol()\nconst _type = Symbol()\nconst _singular = Symbol()\nconst _start = Symbol()\nconst _end = Symbol()\nconst _direction = Symbol()\n\n/**\n * Class representing a relationship between two Nodes\n */\nclass Relationship extends Model\n{\n\t// *** CONSTANTS\n\n\t/**\n\t * @constant\n\t * @member {string}\n\t */\n\tstatic get OUT()\n\t{\n\t\treturn 'relationship.direction.out'\n\t}\n\n\t/**\n\t * @constant\n\t * @member {string}\n\t */\n\tstatic get IN()\n\t{\n\t\treturn 'relationship.direction.in'\n\t}\n\n\t/**\n\t * @constant\n\t * @type {string}\n\t */\n\tstatic get BOTH()\n\t{\n\t\treturn 'relationship.direction.both'\n\t}\n\n\t/**\n\t * @constant\n\t * @type {string}\n\t */\n\tstatic get ANY()\n\t{\n\t\treturn 'relationship.direction.any'\n\t}\n\n\t/**\n\t * @constant\n\t * @type {string}\n\t */\n\tstatic get DEFAULT_TYPE()\n\t{\n\t\treturn 'is_related_to'\n\t}\n\n\n\t// *** PUBLIC METHODS\n\n\t/**\n\t * Creates an instance of Relationship\n\t *\n\t * @param {object|neo4j.types.Relationship} relation Relationship data object or neo4j Relationship\n\t * @param {Graph} graph Current graph\n\t */\n\tconstructor(relation, graph)\n\t{\n\t\tif (relation instanceof neo4j.types.Relationship)\n\t\t{\n\t\t\tsuper(relation.properties)\n\n\t\t\tthis.$entity = relation\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsuper(relation)\n\t\t}\n\n\t\tthis.$graph = graph\n\t}\n\n\tget $direction()\n\t{\n\t\treturn this.constructor.direction\n\t}\n\n\tget $type()\n\t{\n\t\treturn this.constructor.type\n\t}\n\n\t/**\n\t * The neo4j entity ID.\n\t * Note that this could change over time, use id instead.\n\t *\n\t * @readonly\n\t * @type {number}\n\t */\n\tget $id()\n\t{\n\t\treturn this.$entity ? this.$entity.identity.toNumber() : null\n\t}\n\n\t/**\n\t * Whether or not the node is already stored in the graph database.\n\t *\n\t * @readonly\n\t * @type {boolean}\n\t */\n\tget $new()\n\t{\n\t\treturn !this.$entity\n\t}\n\n\t/**\n\t * Whether or not the Node has changed properties.\n\t *\n\t * @readonly\n\t * @type {boolean}\n\t */\n\tget $dirty()\n\t{\n\t\treturn this.$new || super.$dirty\n\t}\n\n\tget start()\n\t{\n\t\treturn this[_start]\n\t}\n\n\tset start(start)\n\t{\n\t\t/**\n\t\t * @private\n\t\t*/\n\t\tthis[_start] = start\n\t}\n\n\tget end()\n\t{\n\t\treturn this[_end]\n\t}\n\n\tset end(end)\n\t{\n\t\t/**\n\t\t * @private\n\t\t*/\n\t\tthis[_end] = end\n\t}\n\n\t/**\n\t * Set property value\n\t *\n\t * @param {string} key Property name\n\t * @param {any} value Property value\n\t */\n\tsetProperty(key, value)\n\t{\n\t\tif (value && value.toNumber)\n\t\t{\n\t\t\tvalue = value.toNumber()\n\t\t}\n\n\t\tsuper.setProperty(key, value)\n\t}\n\n\t/**\n\t * Save the relationship\n\t *\n\t * @param {any} [tx] Transaction\n\t */\n\tasync save(tx = null)\n\t{\n\t\tlet session = null\n\n\t\tif (!tx)\n\t\t{\n\t\t\ttx = DB.beginTransaction()\n\t\t\tsession = tx.session\n\t\t}\n\n\t\tconst left = [Relationship.IN].includes(this.$direction) ? '<' : ''\n\t\tconst right = [Relationship.OUT, Relationship.ANY, Relationship.BOTH].includes(this.$direction) ? '>' : ''\n\n\t\tlet create = `MERGE (start)${ left }-[r:${ this.$type }]-${ right }(end)`\n\t\tlet set = 'SET r += {properties}'\n\n\t\tif (this.$direction === Relationship.BOTH)\n\t\t{\n\t\t\tcreate += `\n\t\t\tMERGE (end)-[r_2:${ this.$type }]->(start)`\n\n\t\t\tset += `\n\t\t\tSET r_2 += {properties}`\n\t\t}\n\n\t\tconst query = `\n\t\t\tMATCH (start:${ this.start.$base } { id: {start} }), (end:${ this.end.$base } { id: {end} })\n\t\t\t${ create }\n\t\t\t${ set }\n\t\t\tRETURN r\n\t\t`\n\n\t\tconst parameters = {\n\t\t\tstart: this.start.id,\n\t\t\tend: this.end.id,\n\t\t\tproperties: this.$data\n\t\t}\n\n\t\t// console.log('save relationship', query, parameters)\n\t\t// console.time('save relationship')\n\n\t\tconst result = await tx.run(query, parameters).then(r => r)\n\n\t\tthis.$entity = result.records[0].get('r')\n\t\tthis.reset()\n\n\t\t// console.timeEnd('save relationship')\n\n\t\tif (session)\n\t\t{\n\t\t\tawait tx.commit().then(r => r)\n\n\t\t\tsession.close()\n\t\t}\n\t}\n\n\t// *** STATIC METHODS\n\n\t/**\n\t * The type of the relationship, will be used as the name of the relationship created in the graph\n\t *\n\t * @static\n\t * @member {string}\n\t */\n\tstatic get type()\n\t{\n\t\treturn this[_type] || this.DEFAULT_TYPE\n\t}\n\n\tstatic set type(value)\n\t{\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tthis[_type] = value\n\t}\n\n\t/**\n\t * If true a relationship will always have only a single related Node\n\t *\n\t * @static\n\t * @member {boolean}\n\t */\n\tstatic get singular()\n\t{\n\t\treturn this[_singular] === true\n\t}\n\n\tstatic set singular(value)\n\t{\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tthis[_singular] = !!value\n\t}\n\n\t/**\n\t * The direction of the relationship, can be {@link Relationship.IN} or {@link Relationship.OUT}\n\t *\n\t * @static\n\t * @member {string}\n\t */\n\tstatic get direction()\n\t{\n\t\treturn this[_direction] || this.OUT\n\t}\n\n\tstatic set direction(value)\n\t{\n\t\t/**\n\t\t * @private\n\t\t*/\n\t\tthis[_direction] = value\n\t}\n\n\t/**\n\t * The related Node class or a function that returns a Node class\n\t *\n\t * @static\n\t * @member {Node|function}\n\t */\n\tstatic get Model()\n\t{\n\t\tif (typeof this[_model] === 'function' && !(this[_model].prototype instanceof Model))\n\t\t{\n\t\t\treturn this[_model]()\n\t\t}\n\n\t\treturn this[_model] || require('./Node')\n\t}\n\n\tstatic set Model(Class)\n\t{\n\t\t/**\n\t\t * @private\n\t\t*/\n\t\tthis[_model] = Class\n\t}\n\n\t/**\n\t * Alias for Model\n\t *\n\t * @static\n\t * @member {Node|function}\n\t */\n\tstatic get model()\n\t{\n\t\treturn this.Model\n\t}\n\n\tstatic set model(Class)\n\t{\n\t\tthis.Model = Class\n\t}\n}\n\nmodule.exports = Relationship\n",
    "static": true,
    "longname": "/Volumes/DATA/Sites/projects/36_maggoo/neo-maggoo/lib/Relationship.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 213,
    "kind": "variable",
    "name": "neo4j",
    "memberof": "lib/Relationship.js",
    "static": true,
    "longname": "lib/Relationship.js~neo4j",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/Relationship.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 3,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 214,
    "kind": "variable",
    "name": "DB",
    "memberof": "lib/Relationship.js",
    "static": true,
    "longname": "lib/Relationship.js~DB",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/Relationship.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 4,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 215,
    "kind": "variable",
    "name": "Model",
    "memberof": "lib/Relationship.js",
    "static": true,
    "longname": "lib/Relationship.js~Model",
    "access": "public",
    "export": false,
    "importPath": "neo-maggoo/lib/Relationship.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 5,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 216,
    "kind": "variable",
    "name": "_model",
    "memberof": "lib/Relationship.js",
    "static": true,
    "longname": "lib/Relationship.js~_model",
    "access": "private",
    "export": false,
    "importPath": "neo-maggoo/lib/Relationship.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 7,
    "undocument": true,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 217,
    "kind": "variable",
    "name": "_type",
    "memberof": "lib/Relationship.js",
    "static": true,
    "longname": "lib/Relationship.js~_type",
    "access": "private",
    "export": false,
    "importPath": "neo-maggoo/lib/Relationship.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 8,
    "undocument": true,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 218,
    "kind": "variable",
    "name": "_singular",
    "memberof": "lib/Relationship.js",
    "static": true,
    "longname": "lib/Relationship.js~_singular",
    "access": "private",
    "export": false,
    "importPath": "neo-maggoo/lib/Relationship.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 9,
    "undocument": true,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 219,
    "kind": "variable",
    "name": "_start",
    "memberof": "lib/Relationship.js",
    "static": true,
    "longname": "lib/Relationship.js~_start",
    "access": "private",
    "export": false,
    "importPath": "neo-maggoo/lib/Relationship.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 10,
    "undocument": true,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 220,
    "kind": "variable",
    "name": "_end",
    "memberof": "lib/Relationship.js",
    "static": true,
    "longname": "lib/Relationship.js~_end",
    "access": "private",
    "export": false,
    "importPath": "neo-maggoo/lib/Relationship.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 11,
    "undocument": true,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 221,
    "kind": "variable",
    "name": "_direction",
    "memberof": "lib/Relationship.js",
    "static": true,
    "longname": "lib/Relationship.js~_direction",
    "access": "private",
    "export": false,
    "importPath": "neo-maggoo/lib/Relationship.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 222,
    "kind": "class",
    "name": "Relationship",
    "memberof": "lib/Relationship.js",
    "static": true,
    "longname": "lib/Relationship.js~Relationship",
    "access": "public",
    "export": true,
    "importPath": "neo-maggoo/lib/Relationship.js",
    "importStyle": "Relationship",
    "description": "Class representing a relationship between two Nodes",
    "lineNumber": 17,
    "interface": false,
    "extends": [
      "Model"
    ]
  },
  {
    "__docId__": 223,
    "kind": "get",
    "name": "OUT",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Relationship.js~Relationship.OUT",
    "access": "public",
    "description": "",
    "lineNumber": 25,
    "unknown": [
      {
        "tagName": "@constant",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 224,
    "kind": "get",
    "name": "IN",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Relationship.js~Relationship.IN",
    "access": "public",
    "description": "",
    "lineNumber": 34,
    "unknown": [
      {
        "tagName": "@constant",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 225,
    "kind": "get",
    "name": "BOTH",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Relationship.js~Relationship.BOTH",
    "access": "public",
    "description": "",
    "lineNumber": 43,
    "unknown": [
      {
        "tagName": "@constant",
        "tagValue": ""
      }
    ],
    "type": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 226,
    "kind": "get",
    "name": "ANY",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Relationship.js~Relationship.ANY",
    "access": "public",
    "description": "",
    "lineNumber": 52,
    "unknown": [
      {
        "tagName": "@constant",
        "tagValue": ""
      }
    ],
    "type": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 227,
    "kind": "get",
    "name": "DEFAULT_TYPE",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Relationship.js~Relationship.DEFAULT_TYPE",
    "access": "public",
    "description": "",
    "lineNumber": 61,
    "unknown": [
      {
        "tagName": "@constant",
        "tagValue": ""
      }
    ],
    "type": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 228,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Relationship.js~Relationship#constructor",
    "access": "public",
    "description": "Creates an instance of Relationship",
    "lineNumber": 75,
    "params": [
      {
        "nullable": null,
        "types": [
          "object",
          "neo4j.types.Relationship"
        ],
        "spread": false,
        "optional": false,
        "name": "relation",
        "description": "Relationship data object or neo4j Relationship"
      },
      {
        "nullable": null,
        "types": [
          "Graph"
        ],
        "spread": false,
        "optional": false,
        "name": "graph",
        "description": "Current graph"
      }
    ]
  },
  {
    "__docId__": 229,
    "kind": "member",
    "name": "$entity",
    "memberof": "lib/Relationship.js~Relationship",
    "static": false,
    "longname": "lib/Relationship.js~Relationship#$entity",
    "access": "public",
    "description": null,
    "lineNumber": 81,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 230,
    "kind": "member",
    "name": "$graph",
    "memberof": "lib/Relationship.js~Relationship",
    "static": false,
    "longname": "lib/Relationship.js~Relationship#$graph",
    "access": "public",
    "description": null,
    "lineNumber": 88,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 231,
    "kind": "get",
    "name": "$direction",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Relationship.js~Relationship#$direction",
    "access": "public",
    "description": null,
    "lineNumber": 91,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 232,
    "kind": "get",
    "name": "$type",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Relationship.js~Relationship#$type",
    "access": "public",
    "description": null,
    "lineNumber": 96,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 233,
    "kind": "get",
    "name": "$id",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Relationship.js~Relationship#$id",
    "access": "public",
    "description": "The neo4j entity ID.\nNote that this could change over time, use id instead.",
    "lineNumber": 108,
    "unknown": [
      {
        "tagName": "@readonly",
        "tagValue": ""
      }
    ],
    "type": {
      "nullable": null,
      "types": [
        "number"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 234,
    "kind": "get",
    "name": "$new",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Relationship.js~Relationship#$new",
    "access": "public",
    "description": "Whether or not the node is already stored in the graph database.",
    "lineNumber": 119,
    "unknown": [
      {
        "tagName": "@readonly",
        "tagValue": ""
      }
    ],
    "type": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 235,
    "kind": "get",
    "name": "$dirty",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Relationship.js~Relationship#$dirty",
    "access": "public",
    "description": "Whether or not the Node has changed properties.",
    "lineNumber": 130,
    "unknown": [
      {
        "tagName": "@readonly",
        "tagValue": ""
      }
    ],
    "type": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": null
    }
  },
  {
    "__docId__": 236,
    "kind": "get",
    "name": "start",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Relationship.js~Relationship#start",
    "access": "public",
    "description": null,
    "lineNumber": 135,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 237,
    "kind": "set",
    "name": "start",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Relationship.js~Relationship#start",
    "access": "public",
    "description": null,
    "lineNumber": 140,
    "undocument": true
  },
  {
    "__docId__": 238,
    "kind": "member",
    "name": "[_start]",
    "memberof": "lib/Relationship.js~Relationship",
    "static": false,
    "longname": "lib/Relationship.js~Relationship#[_start]",
    "access": "private",
    "description": "",
    "lineNumber": 145,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 239,
    "kind": "get",
    "name": "end",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Relationship.js~Relationship#end",
    "access": "public",
    "description": null,
    "lineNumber": 148,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 240,
    "kind": "set",
    "name": "end",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Relationship.js~Relationship#end",
    "access": "public",
    "description": null,
    "lineNumber": 153,
    "undocument": true
  },
  {
    "__docId__": 241,
    "kind": "member",
    "name": "[_end]",
    "memberof": "lib/Relationship.js~Relationship",
    "static": false,
    "longname": "lib/Relationship.js~Relationship#[_end]",
    "access": "private",
    "description": "",
    "lineNumber": 158,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 242,
    "kind": "method",
    "name": "setProperty",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "lib/Relationship.js~Relationship#setProperty",
    "access": "public",
    "description": "Set property value",
    "lineNumber": 167,
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "key",
        "description": "Property name"
      },
      {
        "nullable": null,
        "types": [
          "any"
        ],
        "spread": false,
        "optional": false,
        "name": "value",
        "description": "Property value"
      }
    ],
    "return": null
  },
  {
    "__docId__": 243,
    "kind": "method",
    "name": "save",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": true,
    "static": false,
    "longname": "lib/Relationship.js~Relationship#save",
    "access": "public",
    "description": "Save the relationship",
    "lineNumber": 182,
    "params": [
      {
        "nullable": null,
        "types": [
          "any"
        ],
        "spread": false,
        "optional": true,
        "name": "tx",
        "description": "Transaction"
      }
    ],
    "return": null
  },
  {
    "__docId__": 245,
    "kind": "get",
    "name": "type",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Relationship.js~Relationship.type",
    "access": "public",
    "description": "The type of the relationship, will be used as the name of the relationship created in the graph",
    "lineNumber": 246,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 246,
    "kind": "set",
    "name": "type",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Relationship.js~Relationship.type",
    "access": "public",
    "description": null,
    "lineNumber": 251,
    "undocument": true
  },
  {
    "__docId__": 247,
    "kind": "member",
    "name": "[_type]",
    "memberof": "lib/Relationship.js~Relationship",
    "static": true,
    "longname": "lib/Relationship.js~Relationship.[_type]",
    "access": "private",
    "description": "",
    "lineNumber": 256,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 248,
    "kind": "get",
    "name": "singular",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Relationship.js~Relationship.singular",
    "access": "public",
    "description": "If true a relationship will always have only a single related Node",
    "lineNumber": 265,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 249,
    "kind": "set",
    "name": "singular",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Relationship.js~Relationship.singular",
    "access": "public",
    "description": null,
    "lineNumber": 270,
    "undocument": true
  },
  {
    "__docId__": 250,
    "kind": "member",
    "name": "[_singular]",
    "memberof": "lib/Relationship.js~Relationship",
    "static": true,
    "longname": "lib/Relationship.js~Relationship.[_singular]",
    "access": "private",
    "description": "",
    "lineNumber": 275,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 251,
    "kind": "get",
    "name": "direction",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Relationship.js~Relationship.direction",
    "access": "public",
    "description": "The direction of the relationship, can be {@link Relationship.IN} or {@link Relationship.OUT}",
    "lineNumber": 284,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 252,
    "kind": "set",
    "name": "direction",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Relationship.js~Relationship.direction",
    "access": "public",
    "description": null,
    "lineNumber": 289,
    "undocument": true
  },
  {
    "__docId__": 253,
    "kind": "member",
    "name": "[_direction]",
    "memberof": "lib/Relationship.js~Relationship",
    "static": true,
    "longname": "lib/Relationship.js~Relationship.[_direction]",
    "access": "private",
    "description": "",
    "lineNumber": 294,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 254,
    "kind": "get",
    "name": "Model",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Relationship.js~Relationship.Model",
    "access": "public",
    "description": "The related Node class or a function that returns a Node class",
    "lineNumber": 303,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 255,
    "kind": "set",
    "name": "Model",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Relationship.js~Relationship.Model",
    "access": "public",
    "description": null,
    "lineNumber": 313,
    "undocument": true
  },
  {
    "__docId__": 256,
    "kind": "member",
    "name": "[_model]",
    "memberof": "lib/Relationship.js~Relationship",
    "static": true,
    "longname": "lib/Relationship.js~Relationship.[_model]",
    "access": "private",
    "description": "",
    "lineNumber": 318,
    "ignore": true,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 257,
    "kind": "get",
    "name": "model",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Relationship.js~Relationship.model",
    "access": "public",
    "description": "Alias for Model",
    "lineNumber": 327,
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 258,
    "kind": "set",
    "name": "model",
    "memberof": "lib/Relationship.js~Relationship",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "lib/Relationship.js~Relationship.model",
    "access": "public",
    "description": null,
    "lineNumber": 332,
    "undocument": true
  },
  {
    "kind": "index",
    "content": "# Neo Maggoo\n\n[![Build Status](https://travis-ci.org/bram-l/neo-maggoo.svg?branch=master)](https://travis-ci.org/bram-l/neo-maggoo)\n[![Coverage Status](https://coveralls.io/repos/github/bram-l/neo-maggoo/badge.svg?branch=master)](https://coveralls.io/github/bram-l/neo-maggoo?branch=master)\n\n### Neo4j OGM for Node.js using proxified ES6 classes\n\n**WARNING: This package is still in an experimental state, currently in active development and could change at any time.**\n\n## Installation\n\n```sh\nnpm install neo-maggoo --save\n```\n\n\n## Requirements\n- Node.js >= 6.0.0\n- Neo4j >= 3.0.0\n\n\n## Docs\n\n[https://bram-l.github.io/neo-maggoo/](https://bram-l.github.io/neo-maggoo/)\n\n\n## Examples\n\n```js\nconst { Node, Relationship, DB } = require('neo-maggoo')\n\n// Node definition\nclass Person extends Node {\n    static get relationships()\n    {\n        return {\n            relatives: {\n                Model: Person,\n                type: 'is_related_to',\n                direction: Relationship.OUT\n            },\n            father: {\n                Model: Person,\n                type: 'is_father_of',\n                direction: Relationship.IN,\n                singular: true // Returns a single node instead of an array\n            },\n            mother: {\n                Model: Person,\n                type: 'is_mother_of',\n                direction: Relationship.IN,\n                singular: true // Returns a single node instead of an array\n            }\n        }\n    }\n}\n\n// Initialize database connection\nDB.init(NEO4J_BOLT_URL, NEO4J_USER, NEO4J_PASSWORD)\n```\n\n\n### READ\n\nGet all nodes\n```js\nconst people = await Person.all()\nassert(people.length)\n```\n\nGet a single node\n```js\n// Find by UUID\nconst person = await Person.get('foo')\nassert(person.id === 'foo')\n```\n```js\n// Find by Neo4j ID (NOTE: this may change over time)\nconst person = await Person.get(1)\nassert(person.$id === 1)\n```\n\nFind nodes using filter\n```js\nconst people = await Person.find({ name: 'foo' })\nassert(people[0].name === 'foo')\n```\n```js\nconst people = await Person.find({ name: 'foo' }, { with: 'relatives' })\nassert(people[0].name === 'foo')\nassert(people[0].relatives.length)\n```\n\nFind with related nodes\n```js\nconst foo = await Person.get('foo', { with: 'relatives' })\nassert(foo.relatives.length)\n```\n```js\nconst foo = await Person.get('foo', { with: 'father.father' })\nassert(foo.father.id)\nassert(foo.father.father.id)\n```\n```js\nconst foo = await Person.get('foo', { with: ['father.father', 'mother'] })\nassert(foo.father.id)\nassert(foo.father.father.id)\nassert(foo.mother.id)\n```\n```js\nconst foo = await Person.get('foo', { with: { relatives: { name: 'bar' }, 'relatives.father': true } })\nassert(foo.relatives[0].name === 'bar')\nassert(foo.relatives[0].father.id)\n```\n\nFind nodes using query\n```js\nconst people = await Person.query('MATCH (n) WHERE n.id = {id}', { id: foo }, { with: 'relatives' })\nassert(people[0].id === 'foo')\nassert(people[0].relatives.length)\n```\n\nCount nodes\n```js\nconst total = await Person.count()\nassert(total > 0)\n```\n```js\nconst total = await Person.count({ name: foo })\nassert(total > 0)\n```\n```js\nconst total = await Person.count('WHERE n.name = {name}', { name: foo })\nassert(total > 0)\n```\n\n### WRITE\n\nSave an entire graph\n```js\nconst foo = await Person.get('foo', { with: 'father' })\nfoo.father.name = 'baz'\nawait foo.save(true) // Will save foo.father\n```\n\nSave nested nodes\n```js\nconst foo = new Person()\nconst bar = new Person()\nfoo.relatives.push(bar)\nawait foo.save(true) // Saves foo & bar, and creates a 'is_related_to' relationship\n```\n\nDelete collection\n```js\nconst people = await Person.all()\nawait people.delete()\n```\n\nDelete an entire graph\n```js\nconst foo = await Person.get('foo', { with: 'relatives' })\nawait foo.delete(true) // Deletes foo and its related nodes\n```\n",
    "longname": "/Volumes/DATA/Sites/projects/36_maggoo/neo-maggoo/README.md",
    "name": "./README.md",
    "static": true,
    "access": "public"
  },
  {
    "kind": "packageJSON",
    "content": "{\n  \"name\": \"neo-maggoo\",\n  \"version\": \"0.6.3\",\n  \"description\": \"Futuristic Models & Collections for Neo4j\",\n  \"directories\": {\n    \"test\": \"test\"\n  },\n  \"scripts\": {\n    \"test\": \"NODE_ENV=test JASMINE_CONFIG_PATH=jasmine.json node --harmony node_modules/jasmine/bin/jasmine.js\",\n    \"cover\": \"NODE_ENV=test JASMINE_CONFIG_PATH=jasmine.json node --harmony ./node_modules/nyc/bin/nyc.js --reporter=lcov node_modules/jasmine/bin/jasmine.js\",\n    \"coveralls\": \"NODE_ENV=test JASMINE_CONFIG_PATH=jasmine.json node --harmony ./node_modules/nyc/bin/nyc.js --reporter=text-lcov node_modules/jasmine/bin/jasmine.js | coveralls\",\n    \"docs\": \"esdoc\",\n    \"lint\": \"eslint --quiet lib/*\"\n  },\n  \"author\": \"Bram Loogman <bram@moderntimes.nu>\",\n  \"license\": \"MIT\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/bram-l/neo-maggoo.git\"\n  },\n  \"dependencies\": {\n    \"deepmerge\": \"^1.5.2\",\n    \"maggoo\": \"^0.4.1\",\n    \"neo4j-driver\": \"^1.5.1\",\n    \"shortid\": \"^2.2.8\"\n  },\n  \"devDependencies\": {\n    \"babel-eslint\": \"^8.0.3\",\n    \"babel-plugin-istanbul\": \"^4.1.5\",\n    \"babel-preset-es2017\": \"^6.24.1\",\n    \"babel-register\": \"^6.26.0\",\n    \"coveralls\": \"^3.0.0\",\n    \"esdoc\": \"^1.0.4\",\n    \"esdoc-node\": \"^1.0.2\",\n    \"esdoc-standard-plugin\": \"^1.0.0\",\n    \"eslint\": \"^4.13.1\",\n    \"jasmine\": \"^2.8.0\",\n    \"jasmine-fail-fast\": \"^2.0.0\",\n    \"jasmine-spec-reporter\": \"^4.2.1\",\n    \"nyc\": \"^10.3.2\"\n  },\n  \"nyc\": {\n    \"include\": [\n      \"lib/*.js\"\n    ],\n    \"require\": [\n      \"babel-register\"\n    ],\n    \"sourceMap\": false,\n    \"instrument\": false\n  },\n  \"babel\": {\n    \"presets\": [\n      \"es2017\"\n    ],\n    \"env\": {\n      \"test\": {\n        \"plugins\": [\n          \"istanbul\"\n        ]\n      }\n    }\n  }\n}\n",
    "longname": "/Volumes/DATA/Sites/projects/36_maggoo/neo-maggoo/package.json",
    "name": "package.json",
    "static": true,
    "access": "public"
  }
]